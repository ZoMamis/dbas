function AjaxSiteHandler(){this.sendNewPremiseForArgument=function(b,c,f){var a=$("#"+hiddenCSRFTokenId).val();$.ajax({url:"ajax_set_new_premises_for_argument",method:"POST",data:{arg_uid:b,attack_type:c,premisegroups:JSON.stringify(f)},dataType:"json",async:true,headers:{"X-CSRF-Token":a}}).done(function e(g){new InteractionHandler().callbackIfDoneForSendNewPremisesArgument(g)}).fail(function d(){new GuiHandler().showDiscussionError(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 6). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".")})};this.sendNewStartPremise=function(f,b,e){var a=$("#"+hiddenCSRFTokenId).val();$.ajax({url:"ajax_set_new_start_premise",method:"POST",data:{premisegroups:JSON.stringify(f),conclusion_id:b,supportive:e},dataType:"json",async:true,headers:{"X-CSRF-Token":a}}).done(function d(g){new InteractionHandler().callbackIfDoneForSendNewStartPremise(g)}).fail(function c(){new GuiHandler().showDiscussionError(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 7). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".")})};this.sendNewStartStatement=function(d){var a=$("#"+hiddenCSRFTokenId).val();$.ajax({url:"ajax_set_new_start_statement",method:"POST",data:{statement:d},dataType:"json",async:true,headers:{"X-CSRF-Token":a}}).done(function c(e){new InteractionHandler().callbackIfDoneForSendNewStartStatement(e)}).fail(function b(){new GuiHandler().showDiscussionError(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 8). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".")})};this.sendNewIssue=function(d,e){var a=$("#"+hiddenCSRFTokenId).val();$("#add-topic-error").hide();$.ajax({url:"ajax_set_new_issue",method:"POST",data:{info:d,title:e},dataType:"json",async:true,headers:{"X-CSRF-Token":a}}).done(function c(f){new InteractionHandler().callbackIfDoneForSendNewIssue(f)}).fail(function b(){$("#add-topic-error-text").text(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 9). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".");$("#add-topic-error").show();new Helper().delay(function(){$("#add-topic-error").hide()},2500)})};this.getLogfileForStatement=function(f){var a=$("#"+hiddenCSRFTokenId).val(),b,c;$.ajax({url:"ajax_get_logfile_for_statement",method:"GET",data:{uid:f},dataType:"json",async:true,headers:{"X-CSRF-Token":a},beforeSend:function(h,g){b=g.data;c=this.url}}).done(function e(g){new InteractionHandler().callbackIfDoneForGettingLogfile(g)}).fail(function d(){$("#"+popupEditStatementErrorDescriptionId).html(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 15). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".")})};this.sendCorrectureOfStatement=function(e,h,d){var a=$("#"+hiddenCSRFTokenId).val(),b,c;$.ajax({url:"ajax_set_correcture_of_statement",method:"POST",data:{uid:e,text:h},dataType:"json",async:true,headers:{"X-CSRF-Token":a},beforeSend:function(j,i){b=i.data;c=this.url}}).done(function g(i){new InteractionHandler().callbackIfDoneForSendCorrectureOfStatement(i,d)}).fail(function f(){$("#"+popupEditStatementErrorDescriptionId).html(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 13). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".")})};this.getShortenUrl=function(e){var d=encodeURI(e),b,c;$.ajax({url:"ajax_get_shortened_url",method:"GET",dataType:"json",data:{url:d,issue:new Helper().getCurrentIssueId()},async:true,beforeSend:function(h,g){b=g.data;c=this.url}}).done(function a(g){new InteractionHandler().callbackIfDoneForShortenUrl(g)}).fail(function f(){$("#"+popupUrlSharingInputId).val(e)})};this.getMoreInfosAboutArgument=function(d){var a=$("#"+hiddenCSRFTokenId).val();$.ajax({url:"ajax_get_infos_about_argument",method:"POST",data:{uid:d},dataType:"json",headers:{"X-CSRF-Token":a}}).done(function c(e){new InteractionHandler().callbackIfDoneForGettingInfosAboutArgument(e)}).fail(function b(){new GuiHandler().showDiscussionError(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 8). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".")})};this.getMoreInfosAboutOpinion=function(f,e,g){var h=f=="argument",d=e=="None"?g:e,a=$("#"+hiddenCSRFTokenId).val();$.ajax({url:"ajax_get_user_with_same_opinion",method:"GET",data:{is_argument:h,uids:d},dataType:"json",headers:{"X-CSRF-Token":a}}).done(function c(i){new InteractionHandler().callbackIfDoneForGettingMoreInfosAboutOpinion(i,h)}).fail(function b(){new GuiHandler().showDiscussionError(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 10). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".")})};this.fuzzySearch=function(j,m,h,c){var d,a,l=$("#"+m),b='<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>',n=m.split("-").length==6?m.split("-")[5]:"0",g=$("#"+discussionBubbleSpaceId);if(l.val().length==0){$("#"+proposalStatementListGroupId).empty();$("#"+proposalPremiseListGroupId).empty();$("#"+proposalEditListGroupId).empty();$('p[id^="current_"]').each(function(){$(this).parent().remove()});return}if(h!=fuzzy_statement_popup){if(g.find("#current_"+n).length==0){var k=$("<p>").addClass("triangle-r").attr("id","current_"+n).html(j+"..."+b),f=$("<div>").addClass("line-wrapper-r").append(k).hide().fadeIn();f.insertAfter(g.find("div:last-child"));setInterval(function(){$(".glyphicon-pencil").fadeTo("slow",0.2,function(){$(".glyphicon-pencil").fadeTo("slow",1,function(){})})},1000)}else{$("#current_"+n).html(j+"..."+b)}}new GuiHandler().setMaxHeightForBubbleSpace();$.ajax({url:"ajax_fuzzy_search",method:"GET",dataType:"json",data:{value:j,type:h,extra:c,issue:new Helper().getCurrentIssueId()},async:true,global:false,beforeSend:function(p,o){d=o.data;a=this.url}}).done(function i(o){new InteractionHandler().callbackIfDoneFuzzySearch(o,m,h);new GuiHandler().hideDiscussionError()}).fail(function e(){new Helper().delay(function o(){new GuiHandler().showDiscussionError(_t(requestFailed)+" ("+new Helper().startWithLowerCase(_t(errorCode))+" 11). "+_t(doNotHesitateToContact)+". "+_t(restartOnError)+".")},350)});l.focus()}};function DiscussionGraph(){this.showGraph=function(){$.ajax({url:"/export/sigma",type:"GET",dataType:"json",async:true}).done(function(a){new DiscussionGraph().callbackIfDoneForDiscussionGraph(a)}).fail(function(){new DiscussionGraph().setDefaultViewParams(false,null);new GuiHandler().showDiscussionError(_t(internalError))})};this.callbackIfDoneForDiscussionGraph=function(d){var b=$.parseJSON(d);try{s=this.getSigmaGraph(b)}catch(c){new DiscussionGraph().setDefaultViewParams(false,null);new GuiHandler().showDiscussionError(_t(internalError))}var a=sigma.plugins.dragNodes(s,s.renderers[0]);a.bind("startdrag",function(e){s.stopForceAtlas2()});a.bind("drop",function(e){});$("#graph-view-container-space").attr("style","height:95%; float: left;");$("#start-view").click(function(){new DiscussionGraph().setDefaultViewParams(true,b)});$("#show-content").click(function(){s.settings({labelThreshold:0,defaultLabelColor:"#2E2E2E"});$("#show-content").hide();$("#hide-content").show()});$("#hide-content").click(function(){s.settings({labelThreshold:8});$("#show-content").show();$("#hide-content").hide()});$("#wide-view").click(function(){if(!s.isForceAtlas2Running()){s.startForceAtlas2({worker:true,linLogMode:false,strongGravityMode:true,barnesHutTheta:10,scalingRatio:20})}$("#wide-view").hide();$("#tight-view").show();s.configForceAtlas2({strongGravityMode:false,linLogMode:true,outboundAttractionDistribution:false})});$("#tight-view").click(function(){s.configForceAtlas2({outboundAttractionDistribution:true});$("#wide-view").show();$("#tight-view").hide()});$("#"+closeGraphViewContainerId).click(function(){new DiscussionGraph().setDefaultViewParams(false,null)})};this.setDefaultViewParams=function(a,b){$("#hide-content").hide();$("#show-content").show();$("#wide-view").show();$("#tight-view").hide();s.stopForceAtlas2();s.killForceAtlas2();s.graph.clear();s.graph.kill();if(a){try{s=this.getSigmaGraph(b)}catch(c){new DiscussionGraph().setDefaultViewParams(false,null);new GuiHandler().showDiscussionError(_t(internalError))}}else{$("#"+graphViewContainerSpaceId).empty()}};this.getSigmaGraph=function(a){return new sigma({graph:a,renderer:{type:"canvas",container:graphViewContainerSpaceId},settings:{edgeColor:"default",defaultEdgeColor:"#666",defaultEdgeLabelColor:"#848484",defaultEdgeLabelSize:8,edgeLabelSize:"proportional",edgeLabelSizePowRatio:1,edgeLabelThreshold:0,defaultLabelHoverColor:"node",defaultHoverLabelBGColor:"#EBEBEB",defaultLabelSize:13,defaultNodeType:"border",defaultNodeBorderColor:"#000",borderSize:3,enableEdgeHovering:true,edgeHoverColor:"edge",defaultEdgeHoverColor:"#000",edgeHoverSizeRatio:1,edgeHoverExtremities:true,doubleClickEnabled:false,hideEdgesOnMove:false,zoomMin:0.2,zoomMax:1,minArrowSize:10,maxEdgeSize:2,sideMargin:1}}).startForceAtlas2({worker:true,strongGravityMode:true,barnesHutTheta:10,scalingRatio:20}).bind("doubleClickNode",function(c){var b="<br><br><ul><li>edit</li><li>supportes</li><li>author</li></ul>";displayConfirmationDialogWithoutCancelAndFunction("Edit Node: "+c.data.node.id,"Content: "+c.data.node.label+b)}).refresh()}};function GuiHandler(){var a;this.setHandler=function(b){a=b};this.appendAddPremiseRow=function(){var e=$("#add-premise-container-body"),d=$("#"+sendNewPremiseId),h=new Date().getTime(),b=$("<div>").attr("style","padding-bottom: 2em").addClass("container-three-divs"),m=$("<div>"),l=$("<div>").addClass("flex-div"),g=$("<div>"),f=$("<h5>").attr("style","float:left; line-height:20px; text-align:center;").text("Because..."),c="add-premise-container-main-input-"+h,k=$("<input>").attr("id",c).attr("type","text").attr("class","form-control").attr("autocomplete","off").attr("placeholder","Your statement"),j=$("<img>").attr("class","icon-rem-premise").attr("src",mainpage+"static/images/icon_minus1.png").attr("title",e.find(".icon-rem-premise").first().attr("title")),i=$("<img>").attr("class","icon-add-premise").attr("src",mainpage+"static/images/icon_plus1.png").attr("title",e.find(".icon-add-premise").first().attr("title"));b.append(m.append(f)).append(l.append(k)).append(g.append(j).append(i));$("#"+addPremiseContainerBodyId).append(b);i.click(function(){new GuiHandler().appendAddPremiseRow();$(this).hide().prev().show();d.val(_t(saveMyStatements))});e.find(".icon-rem-premise").each(function(){$(this).click(function(){var o=$(this).parent().parent().find("input").attr("id"),n=o.split("-").length==6?o.split("-")[5]:"0";$("#current_"+n).fadeOut().remove();$(this).parent().parent().remove();e.find("div").children().last().show();if(e.find(".container-three-divs").length==1){e.find(".icon-rem-premise").hide();d.val(_t(saveMyStatement))}else{e.find(".icon-rem-premise").show();d.val(_t(saveMyStatements))}})});j.show();$("#"+c).keyup(function(){new Helper().delay(function(){var n=new Helper().escapeHtml($("#"+c).val());new AjaxSiteHandler().fuzzySearch(n,c,fuzzy_add_reason,"")},200)})};this.setErrorDescription=function(b){$("#"+discussionErrorDescriptionId).html(b);$("#"+discussionErrorDescriptionSpaceId).show()};this.setDisplayStyleAsDiscussion=function(){this.setImageInactive($("#"+displayStyleIconGuidedId));this.setImageActive($("#"+displayStyleIconIslandId));this.setImageActive($("#"+displayStyleIconExpertId));$("#"+islandViewContainerId).hide();$("#"+graphViewContainerId).hide();$("#"+discussionContainerId).show();$("#"+headerContainerId).show();$("#"+breadcrumbContainerId).show()};this.setDisplayStyleAsIsland=function(){this.setImageActive($("#"+displayStyleIconGuidedId));this.setImageInactive($("#"+displayStyleIconIslandId));this.setImageActive($("#"+displayStyleIconExpertId));$("#"+islandViewContainerId).fadeIn("slow");$("#"+graphViewContainerId).hide();$("#"+discussionContainerId).hide()};this.setDisplayStyleAsGraphView=function(){this.setImageActive($("#"+displayStyleIconGuidedId));this.setImageActive($("#"+displayStyleIconIslandId));this.setImageInactive($("#"+displayStyleIconExpertId));$("#"+islandViewContainerId).hide();$("#"+discussionContainerId).hide();$("#"+headerContainerId).hide();$("#"+breadcrumbContainerId).hide();new GuiHandler().hideDiscussionError();new DiscussionGraph().showGraph();var b=new Helper().getMaxSizeOfGraphViewContainer();$("#"+graphViewContainerId).attr("style","height: "+b+"px; margin-left: 2em; margin-right: 2em; padding: 0 0 0 0;")};this.setImageInactive=function(b){b.addClass("inactive-image").removeClass("icon-badge").css("cursor","not-allowed")};this.setImageActive=function(b){b.removeClass("inactive-image").addClass("icon-badge").css("cursor","pointer")};this.setMaxHeightForBubbleSpace=function(){var c=$("#"+discussionBubbleSpaceId),b=0,d=new Helper().getMaxSizeOfDiscussionViewContainer(),f,e=c.find("*[id*=now]");$.each(c.find("div p"),function(){b+=$(this).outerHeight(true);if($(this).parent().attr("href")=="?breadcrumb=true"){$(this).insertAfter($(this).parent());$(this).prev().remove()}});f=e.length==0?"bottom":e;if(b>d){if(d<300){d=300}c.slimscroll({position:"right",height:d+"px",railVisible:true,alwaysVisible:true,start:f,scrollBy:"10px",allowPageScroll:true})}else{b+=20;if(b<50){c.css("min-height","100px")}else{c.css("height",b+"px").css("min-height","300px")}c.css("min-height","100px").css("max-height",d+"px")}};this.showAddPositionContainer=function(){$("#"+addStatementContainerId).show()};this.showAddPremiseContainer=function(){$("#"+addPremiseContainerId).show()};this.showSetStatementContainer=function(h,s,r,b,d,g,t){var q=new GuiHandler(),c,p,j=$("#"+popupSetPremiseGroupsBodyContent).empty(),k=$("#"+popupSetPremiseGroupsPreviousButton).hide(),l=$("#"+popupSetPremiseGroupsNextButton).hide(),f=$("#"+popupSetPremiseGroupsSendButton).addClass("disabled"),i=$("#"+popupSetPremiseGroupsCounter).hide(),n="insert_statements_page_";f.click(function e(){var w=j.find("input:checked"),v,u,x;for(v=0;v<h.length;v++){x=h[v].split(" "+_t(and)+" ");if(w[v].id.indexOf(attr_more_args)!=-1){for(u=0;u<x.length;u++){s.push([x[u]])}}else{if(w[v].id.indexOf(attr_one_arg)!=-1){s.push(x)}else{s.push([h[v]])}}}if(b==fuzzy_add_reason){new AjaxSiteHandler().sendNewPremiseForArgument(d,g,s)}else{if(b==fuzzy_start_premise){new AjaxSiteHandler().sendNewStartPremise(s,t,r)}else{alert("Todo: unknown type")}}$("#"+popupSetPremiseGroups).modal("hide")});if(h.length==1){c=q.getPageOfSetStatementContainer(0,h[0],r);j.append(c);f.text(_t(saveMyStatement));c.find("input").each(function(){$(this).click(function u(){f.removeClass("disabled")})})}else{k.show().removeClass("href").attr("max",h.length);k.parent().addClass("disabled");l.show().attr("max",h.length);i.show().text("1/"+h.length);f.text(_t(saveMyStatements));for(p=0;p<h.length;p++){c=q.getPageOfSetStatementContainer(p,h[p],r);if(p>0){c.hide()}j.append(c);c.find("input").each(function(){$(this).click(function u(){new GuiHandler().displayNextPageOffSetStatementContainer(j,k,l,i,n)})})}k.click(function m(){new GuiHandler().displayPrevPageOffSetStatementContainer(j,k,l,i,n)});l.click(function o(){new GuiHandler().displayNextPageOffSetStatementContainer(j,k,l,i,n)})}$("#"+popupSetPremiseGroups).modal("show")};this.displayNextPageOffSetStatementContainer=function(c,f,e,b,h){var g=c.find("div:visible"),i=parseInt(g.attr("id").substr(h.length)),d=g.find("input:checked");if(d.length==0){$("#insert_statements_page_error").fadeIn()}else{$("#insert_statements_page_error").fadeOut();if(i<(parseInt(e.attr("max"))-1)){g.hide().next().fadeIn();f.parent().removeClass("disabled");b.show().text((i+2)+"/"+e.attr("max"));if((i+2)==parseInt(e.attr("max"))){e.parent().addClass("disabled")}}else{$("#"+popupSetPremiseGroupsSendButton).removeClass("disabled")}}};this.displayPrevPageOffSetStatementContainer=function(c,e,d,b,g){var f=c.find("div:visible"),h=parseInt(f.attr("id").substr(g.length));if(h>0){f.hide().prev().fadeIn();d.parent().removeClass("disabled");b.show().text((h)+"/"+e.attr("max"));if(h==0){e.parent().addClass("disabled")}}};this.getPageOfSetStatementContainer=function(q,r,p){var b=$("#insert_statements_page_"),n=b.clone(),d=b.attr("id"),m=r.split(" "+_t(and)+" "),j=$("#"+addPremiseContainerMainInputIntroId).text(),g,f,e,l,k,o,c,h;if(j.match(/\.$/)){j=j.substr(0,j.length-1)+", "}n.attr("id",d+q).attr("page",q).show();n.find("#"+popupSetPremiseGroupsStatementCount).text(m.length);l=n.find("#"+popupSetPremiseGroupsListMoreArguments);o=n.find("#"+popupSetPremiseGroupsOneBigStatement);g=n.find("#insert_more_arguments");f=n.find("#insert_one_argument");e=n.find("#insert_dont_care");g.attr("id",g.attr("id")+"_"+q);f.attr("id",f.attr("id")+"_"+q);e.attr("id",e.attr("id")+"_"+q);g.attr("name",g.attr("name")+"_"+q);f.attr("name",f.attr("name")+"_"+q);e.attr("name",e.attr("name")+"_"+q);g.parent().attr("for",g.parent().attr("for")+"_"+q);f.parent().attr("for",f.parent().attr("for")+"_"+q);e.parent().attr("for",e.parent().attr("for")+"_"+q);c=p?_t(itIsTrueThat):_t(itIsFalseThat);k=j+" "+_t(because)+" "+c;for(h=0;h<m.length;h++){l.append($("<li>").text(j+" "+_t(because)+" "+m[h]+"."));k+=" "+h==0?" "+m[h]:(" "+_t(andAtTheSameTime)+" "+c+" "+m[h])}o.text(k+".");return n};this.setStatementsAsProposal=function(m,l,k){var j=$("#"+l),i;if(k==fuzzy_start_premise){$("#"+proposalPremiseListGroupId).empty()}else{if(k==fuzzy_start_statement){$("#"+proposalStatementListGroupId).empty()}else{if(k==fuzzy_add_reason){$("#"+proposalPremiseListGroupId).empty()}else{if(k==fuzzy_statement_popup){$("#"+proposalEditListGroupId).empty()}}}}if(Object.keys(m).length==0){return}var d,c,f,e,h,b,g;j.focus();$.each(m.values,function(n,o){d=n.split("_");b=parseInt(d[0]);g=d[1];c=j.val();i=o;o=o.replace(new RegExp("("+(c+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")+")","gi"),"</b>$1<b>");f=$("<button>").attr("type","button").attr("class","list-group-item").attr("id","proposal_"+g).attr("text",i).hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});e=$("<span>").attr("class","badge").text(m.distance_name+" "+b);h=$("<span>").attr("id","proposal_"+g+"_text").html(o);f.append(e).append(h).click(function(){j.val($(this).attr("text"));$("#"+proposalStatementListGroupId).empty();$("#"+proposalPremiseListGroupId).empty();$("#"+proposalEditListGroupId).empty()});if(k==fuzzy_start_premise){$("#"+proposalPremiseListGroupId).append(f)}else{if(k==fuzzy_start_statement){$("#"+proposalStatementListGroupId).append(f)}else{if(k==fuzzy_add_reason){$("#"+proposalPremiseListGroupId).append(f)}else{if(k==fuzzy_statement_popup){$("#"+proposalEditListGroupId).append(f)}}}}})};this.showDiscussionError=function(b){$("#"+discussionFailureRowId).fadeIn("slow");$("#"+discussionFailureMsgId).html(b);$("#"+contactOnErrorId).click(function(){var d="Report "+new Helper().getTodayAsDate(),c="URL: "+window.location.href,f=_t(fillLine).toUpperCase(),e={content:d+"\n"+c+"\n"+f,name:$("#header_user").parent().text().replace(/\s/g,"")};new Helper().redirectInNewTabForContact(e)})};this.showEditStatementsPopup=function(){var e,g,d,f,c=new Helper(),b=[];$("#"+popupEditStatementId).modal("show");$("#"+popupEditStatementWarning).hide();e=$("<table>").attr("class","table table-condensed table-hover").attr("border","0").attr("style","border-collapse: separate; border-spacing: 5px 5px;");d=$("<td>").html("<strong>"+_t(text)+"</strong>").css("text-align","center");f=$("<td>").html("<strong>"+_t(options)+"</strong>").css("text-align","right");e.append($("<tr>").append(d).append(f));$("#"+discussionSpaceId+" li:not(:last-child) label:nth-child(even)").each(function(){g=c.createRowInEditDialog($(this).text(),$(this).attr("for").substr("item_".length),$(this).attr("id"));if($.inArray($(this).attr("id"),b)==-1){e.append(g);b.push($(this).attr("id"))}});$("#"+popupEditStatementContentId).empty().append(e);$("#"+popupEditStatementTextareaId).hide();$("#"+popupEditStatementDescriptionId).hide();$("#"+popupEditStatementSubmitButtonId).hide();$("#"+proposalEditListGroupId).empty()};this.showUrlSharingPopup=function(){$("#"+popupUrlSharingId).modal("show");new AjaxSiteHandler().getShortenUrl(window.location)};this.showGeneratePasswordPopup=function(){$("#"+popupGeneratePasswordId).modal("show");$("#"+popupGeneratePasswordCloseButtonId).click(function(){$("#"+popupGeneratePasswordId).modal("hide")});$("#"+popupLoginCloseButton).click(function(){$("#"+popupGeneratePasswordId).modal("hide")})};this.showEditFieldsInEditPopup=function(){$("#"+popupEditStatementSubmitButtonId).fadeIn("slow");$("#"+popupEditStatementTextareaId).fadeIn("slow");$("#"+popupEditStatementDescriptionId).fadeIn("slow")};this.showStatementCorrectionsInPopup=function(b){var c,e;c=$("<table>");c.attr("id","edit_statement_table").attr("class","table table-condensed").attr("border","0").attr("style","border-collapse: separate; border-spacing: 5px 5px;");e=$("<tr>");e.append($("<td>").html("<strong>"+_t(date)+"</strong>").css("text-align","center"));e.append($("<td>").html("<strong>"+_t(text)+"</strong>").css("text-align","center"));e.append($("<td>").html("<strong>"+_t(author)+"</strong>").css("text-align","center"));c.append(e);$.each(b.content,function d(f,g){e=$("<tr>").append($("<td>").text(g.date)).append($("<td>").text(g.text)).append($("<td>").text(g.author));c.append(e)});$("#"+popupEditStatementLogfileSpaceId).empty().append(c)};this.showHowToWriteTextPopup=function(){var c="HOW_TO_WRITE_TEXT",b=new Helper().isCookieSet(c);if(!b){$("#"+popupHowToWriteText).modal("show")}$("#"+popupHowToWriteTextOkayButton).click(function(){$("#"+popupHowToWriteText).modal("hide");new Helper().setCookie(c)})};this.hideEditFieldsInEditPopup=function(){$("#"+popupEditStatementSubmitButtonId).hide();$("#"+popupEditStatementTextareaId).hide();$("#"+popupEditStatementDescriptionId).hide()};this.hideLogfileInEditPopup=function(){$("#"+popupEditStatementLogfileSpaceId).empty();$("#"+popupEditStatementLogfileHeaderId).html("")};this.hideandClearEditStatementsPopup=function(){$("#"+popupEditStatementId).modal("hide");$("#"+popupEditStatementContentId).empty();$("#"+popupEditStatementLogfileSpaceId).text("");$("#"+popupEditStatementLogfileHeaderId).text("");$("#"+popupEditStatementTextareaId).text("");$("#"+popupEditStatementErrorDescriptionId).text("");$("#"+popupEditStatementSuccessDescriptionId).text("")};this.hideAndClearUrlSharingPopup=function(){$("#"+popupUrlSharingId).modal("hide");$("#"+popupUrlSharingInputId).val("")};this.hideErrorDescription=function(){$("#"+discussionErrorDescriptionId).html("");$("#"+discussionErrorDescriptionSpaceId).hide()};this.hideSuccessDescription=function(){$("#"+discussionSuccessDescriptionId).html("");$("#"+discussionSuccessDescriptionSpaceId).hide()};this.hideDiscussionError=function(){$("#"+discussionFailureRowId).hide()};this.updateOfStatementInDiscussion=function(b){$("#td_"+b.uid).text(b.text);$("#"+b.uid).text(b.text)};this.resetChangeDisplayStyleBox=function(){this.setDisplayStyleAsDiscussion()};this.resetEditAndRefactorButton=function(e){if(typeof e==="undefined"){e=true}var g=false,d,b,f,c;$("#"+discussionSpaceId+" ul > li").children().each(function(){d=$(this).val();b=$(this).attr("id");f=$(this).hasClass("premise");c=$(this).hasClass("start");if(e){if($(this).prop("tagName").toLowerCase().indexOf("input")>-1&&d.length>0&&$.isNumeric(b)||f||c){g=true;return false}}});if(g){$("#"+editStatementButtonId).show();$("#"+reportButtonId).show()}else{$("#"+editStatementButtonId).hide();$("#"+reportButtonId).hide()}}};function Helper(){this.cutTextOnChar=function(f,e,c){var b,d,a;b=1;a=f.length;while(b*e<a){d=f.indexOf(c,b*e);f=f.substr(0,d)+"<br>"+f.substr(d+c.length);b=b+1}return f};this.swapElements=function(d,c){var a=$(c).clone(true),b=$(d).clone(true);$(c).replaceWith(b);$(d).replaceWith(a)};this.getTodayAsDate=function(){var c=new Date(),b=c.getMonth()+1,a=c.getDate();return((a<10?"0":"")+a+"."+(b<10?"0":"")+b+"."+c.getFullYear())};this.escapeHtml=function(a){var b=document.createElement("div");b.appendChild(document.createTextNode(a));return b.innerHTML};this.getFullHtmlTextOf=function(a){return $("<div>").append(a).html()};this.startWithLowerCase=function(a){return a.substr(0,1).toLowerCase()+a.substr(1)};this.startWithUpperCase=function(a){return a.substr(0,1).toLocaleUpperCase()+a.substr(1)};this.createRowInEditDialog=function(l,i,g){var b,k,h=new GuiHandler(),n=new AjaxSiteHandler(),j,c,e,d;j=$("<tr>");c=$("<td>").text(l).attr("id","td_"+g).attr("for",i);e=$("<td>").css("text-align","right");b=$("<input>").css("margin","2px").attr("type","button").attr("value","edit").attr("class","btn-sm btn button-primary").click(function m(){$("#"+popupEditStatementTextareaId).text($(this).parent().prev().text());$("#"+popupEditStatementContentId+" td").removeClass("text-hover");$(this).parent().prev().addClass("text-hover");$("#"+popupEditStatementErrorDescriptionId).text("");$("#"+popupEditStatementSuccessDescriptionId).text("");h.showEditFieldsInEditPopup();h.hideLogfileInEditPopup();$("#"+popupEditStatementSubmitButtonId).click(function o(){d=$("#"+popupEditStatementContentId+" .text-hover");new AjaxSiteHandler().sendCorrectureOfStatement(d.attr("id").substr(3),$("#"+popupEditStatementTextareaId).val(),d)})}).hover(function f(){$(this).toggleClass("btn-primary",400)});k=$("<input>").css("margin","2px").attr("type","button").attr("value","changelog").attr("class","btn-sm btn button-primary").click(function a(){$("#"+popupEditStatementLogfileHeaderId).html(_t(logfile)+": <strong>"+$(this).parent().prev().text()+"</strong>");$("#"+popupEditStatementErrorDescriptionId).text("");$("#"+popupEditStatementSuccessDescriptionId).text("");$("#"+popupEditStatementContentId+" td").removeClass("text-hover");$(this).parent().prev().addClass("text-hover");n.getLogfileForStatement($(this).parent().prev().attr("id").substr(3));h.hideEditFieldsInEditPopup()}).hover(function f(){$(this).toggleClass("btn-primary",400)});e.append(b);e.append(k);j.append(c);j.append(e);return j};this.getCurrentIssueId=function(){return $("#"+issueDropdownButtonID).attr("issue")};this.setCookie=function(a){this.setCookieForDays(a,7)};this.setCookieForDays=function(c,g){var f=new Date(),e=true;var b=g*24*60*60*1000;f.setTime(f.getTime()+b);var a="expires="+f.toGMTString();document.cookie=c+"="+e+"; "+a+";path=/";$(document).trigger("user_cookie_consent_changed",{consent:e})};this.isCookieSet=function(e){var d=document.cookie.split(";"),a=false;for(var b=0;b<d.length;b++){var f=d[b].trim();if(f.indexOf(e)==0){a=f.substring(e.length+1,f.length)}}return a};this.redirectInNewTabForContact=function(c){var b=$("<form target='_blank' method='POST' style='display:none;'></form>").attr("action",mainpage+"contact");b.appendTo(document.body);for(var a in c){if(c.hasOwnProperty(a)){b.append($('<input type="hidden" />').attr("name",a).attr("value",c[a]))}}b.submit().remove()};this.getMaxSizeOfGraphViewContainer=function(){var c,b,a;c=$("#"+customBootstrapMenuId);b=$("#footer");a=window.innerHeight;a-=c.outerHeight(true);a-=b.outerHeight(true);a-=this.getPaddingOfElement(c);a-=this.getPaddingOfElement(b);return a};this.getMaxSizeOfDiscussionViewContainer=function(){var a,c,b;a=$("#header-container");b=$("#"+discussionSpaceListId);c=this.getMaxSizeOfGraphViewContainer();c-=a.outerHeight(true);c-=b.outerHeight(true);c-=this.getPaddingOfElement(a);c-=this.getPaddingOfElement(b);return c-10};this.getPaddingOfElement=function(a){return parseInt(a.css("padding-top").replace("px",""))+parseInt(a.css("padding-bottom").replace("px",""))};this.isMobileAgent=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)};this.delay=function(){var a=0;return function(c,b){clearTimeout(a);a=setTimeout(c,b)}}()};function InteractionHandler(){this.callbackIfDoneForSendNewStartStatement=function(a){var b=$.parseJSON(a);if(b.error.length>0){$("#"+addStatementErrorContainer).show();$("#"+addStatementErrorMsg).text(b.error)}else{$("#"+discussionSpaceId+"input:last-child").attr("checked",false).prop("checked",false);window.location.href=b.url}};this.callbackIfDoneForSendNewPremisesArgument=function(a){var b=$.parseJSON(a);if(b.error.length>0){$("#"+addPremiseErrorContainer).show();$("#"+addPremiseErrorMsg).text(b.error)}else{window.location.href=b.url}};this.callbackIfDoneForSendNewStartPremise=function(a){var b=$.parseJSON(a);if(b.error.length>0){$("#"+addPremiseErrorContainer).show();$("#"+addPremiseErrorMsg).text(b.error)}else{window.location.href=b.url}};this.callbackIfDoneForGettingLogfile=function(a){var b=$.parseJSON(a);if(b.error.length==0){$("#"+popupEditStatementLogfileSpaceId).text("");new GuiHandler().showStatementCorrectionsInPopup(b)}else{$("#"+popupEditStatementLogfileSpaceId).text(b.error)}};this.callbackIfDoneForSendCorrectureOfStatement=function(b,a){var c=$.parseJSON(b);if(c.error.length!=0){$("#"+popupEditStatementErrorDescriptionId).text(c.error)}else{new GuiHandler().updateOfStatementInDiscussion(c,a);$("#"+popupEditStatementErrorDescriptionId).text("");$("#"+popupEditStatementSuccessDescriptionId).text(_t(correctionsSet))}};this.callbackIfDoneForShortenUrl=function(c,b){var d=$.parseJSON(c),a;if(d.error.length==0){a='<a href="'+d.service_url+'" title="'+d.service+'" target="_blank">'+d.service+"</a>";$("#"+popupUrlSharingDescriptionPId).html(_t(feelFreeToShareUrl)+", "+_t(shortenedBy)+" "+a+":");$("#"+popupUrlSharingInputId).val(d.url).attr("data-short-url",d.url)}else{$("#"+popupUrlSharingDescriptionPId).text(_t(feelFreeToShareUrl)+":");$("#"+popupUrlSharingInputId).val(b)}};this.callbackIfDoneFuzzySearch=function(c,b,a){var d=$.parseJSON(c);if(Object.keys(d).length==0){$("#"+proposalStatementListGroupId).empty();$("#"+proposalPremiseListGroupId).empty();$("#"+proposalEditListGroupId).empty()}else{new GuiHandler().setStatementsAsProposal(d,b,a)}};this.callbackIfDoneForGettingInfosAboutArgument=function(c){var m=$.parseJSON(c),l,d;if(m.error.length==0){var f=$("<div>"),n=$("<table>").attr("class","table table-condensed table-hover").attr("border","0").attr("style","border-collapse: separate; border-spacing: 5px 5px;"),j=$("<tr>").append($("<td>").html("<strong>"+_t(avatar)+"</strong>").css("text-align","left")).append($("<td>").html("<strong>"+_t(nickname)+"</strong>").css("text-align","left")),e=$("<tbody>"),b,g,k="",h="",a=0;l=m.text+"<br><br>";l+=_t(messageInfoStatementCreatedBy)+" "+m.author+" ";l+=_t(messageInfoAt)+" "+m.timestamp+".<br>";l+=_t(messageInfoCurrentlySupported)+" "+m.vote_count+" ";l+=_t(messageInfoParticipant)+(m.vote_count==1?"":_t(messageInfoParticipantPl))+".";if(m.vote_count>0){$.each(m.supporter,function(o,i){b=$("<td>").text(i);g=$("<td>").html('<img style="height: 40%;" src="'+m.gravatars[i]+'"></td>');if(a==1){a=0;e.append($("<tr>").append(h).append(k).append(g).append(b))}else{a=1;k=b;h=g}});if(a==1){e.append($("<tr>").append(h).append(k))}}f.append(l).append(n.append(e));displayConfirmationDialogWithoutCancelAndFunction(_t(messageInfoTitle),f);$("#"+popupConfirmDialogId).find(".modal-dialog");new Helper().delay(function(){var i=$("#"+popupConfirmDialogId).find(".modal-body div");if($(window).height()>400&&i.outerHeight(true)>$(window).height()){i.slimScroll({position:"right",railVisible:true,alwaysVisible:true,height:($(window).height()/3*2)+"px"})}},300)}else{l=m.error;d=$("<p>").html(l);displayConfirmationDialogWithoutCancelAndFunction(_t(messageInfoTitle),d)}};this.callbackIfDoneForSendNewIssue=function(f){var h=$.parseJSON(f);if(h.error.length==0){$("#"+popupConfirmDialogId).modal("hide");var b=$("<li>").addClass("enabled"),c=$("<a>").attr("href",h.issue.url).attr("value",h.issue.title),d=$("<span>").text(h.issue.title),g=$("<span>").addClass("badge").attr("style","float: right; margin-left: 1em;").text(h.issue.arg_count),e=$("#"+issueDropdownListID).find("li.divider");b.append(c.append(d).append(g));if(e.length>0){b.insertBefore(e)}}else{$("#add-topic-error-text").text(h.error);$("#add-topic-error").show();new Helper().delay(function(){$("#add-topic-error").hide()},2500)}};this.callbackIfDoneForGettingMoreInfosAboutOpinion=function(d,l){var o=$.parseJSON(d),n,h;if(o.error.length==0){var e=$("<div>"),m=l?$("<span>").text(o.opinions.message):$("<span>").text(o.opinions[0].message),p=$("<table>").attr("class","table table-condensed table-hover").attr("border","0").attr("style","border-collapse: separate; border-spacing: 5px 5px;"),i=$("<tr>").append($("<td>").html("<strong>"+_t(avatar)+"</strong>").css("text-align","left")).append($("<td>").html("<strong>"+_t(nickname)+"</strong>").css("text-align","left")),c=$("<tbody>"),b,f,k="",g="",a=0;p.append($("<thead>").append(i));if(l){n=o.opinions.users}else{n=o.opinions[0].users}$.each(n,function(j,q){b=$("<td>").text(q.nickname);f=$("<td>").html('<img style="height: 40%;" src="'+q.avatar_url+'"></td>');if(a==1){a=0;c.append($("<tr>").append(g).append(k).append(f).append(b))}else{a=1;k=b;g=f}});if(a==1){c.append($("<tr>").append(g).append(k))}e.append(m).append(p.append(c));displayConfirmationDialogWithoutCancelAndFunction(_t(usersWithSameOpinion),e);$("#"+popupConfirmDialogId).find(".modal-dialog");new Helper().delay(function(){h=$("#"+popupConfirmDialogId).find(".modal-body div");if($(window).height()>400&&h.outerHeight(true)>$(window).height()){h.slimScroll({position:"right",railVisible:true,alwaysVisible:true,height:($(window).height()/3*2)+"px"})}},300)}else{new GuiHandler().showDiscussionError(o.error)}};this.sendStatement=function(l,a,h,m,b,f){if(l.length==0){if(f==fuzzy_start_statement){$("#"+addStatementErrorContainer).show();$("#"+addStatementErrorMsg).text(_t(inputEmpty))}else{$("#"+addPremiseErrorContainer).show();$("#"+addPremiseErrorMsg).text(_t(inputEmpty))}}else{var k=[],g=[];if($.isArray(l)){for(var e=0;e<l.length;e++){l[e]=l[e].replace(/\s\s+/g," ");while(l[e].indexOf((_t(and)+" "),l[e].length-(_t(and)+" ").length)!==-1||l[e].indexOf((_t(and)),l[e].length-(_t(and)).length)!==-1){if(l[e].indexOf((_t(and)+" "),l[e].length-(_t(and)+" ").length)!==-1){l[e]=l[e].substr(0,l[e].length-(_t(and)+" ").length)}else{l[e]=l[e].substr(0,l[e].length-(_t(and)).length)}}while(l[e].indexOf((" "),l[e].length-(" ").length)!==-1){l[e]=l[e].substr(0,l[e].length-(" ").length)}if(l[e].toLocaleLowerCase().indexOf(" "+_t(and)+" ")!=-1){k.push(l[e])}else{g.push(l[e])}}}if(k.length>0){var c=new Helper();for(var d=0;d<k.length;d++){k[d]=c.startWithLowerCase(k[d]);if(k[d].match(/\.$/)){k[d]=k[d].substr(0,k[d].length-1)}}new GuiHandler().showSetStatementContainer(k,g,h,f,m,b,a)}else{if(f==fuzzy_start_statement){if(g.length>0){alert("TODO: more than one decided text")}else{new AjaxSiteHandler().sendNewStartStatement(l)}}else{if(f==fuzzy_start_premise){new AjaxSiteHandler().sendNewStartPremise(l,a,h)}else{if(f==fuzzy_add_reason){new AjaxSiteHandler().sendNewPremiseForArgument(m,b,l)}}}}}}};setClickFunctions=function(s,g){$(".icon-add-premise").each(function(){$(this).click(function(){s.appendAddPremiseRow($(this));$(this).hide().prev().show();$("#"+sendNewPremiseId).val(_t(saveMyStatements))})});$("#"+b).click(function b(){if($(this).val()===_t(showAllUsers)){g.getUsersOverview();$(this).val(_t(hideAllUsers))}else{$("#"+adminsSpaceForUsersId).empty();$(this).val(_t(showAllUsers))}});$("#"+listAllArgumentId).click(function e(){if($(this).val()===_t(showAllAttacks)){g.getArgumentOverview()}else{$("#"+adminsSpaceForArgumentsId).empty()}});$("#"+f).click(function f(){$("#"+addStatementContainerId).hide();$("#"+addStatementErrorContainer).hide();$("#"+discussionSpaceId+" li:last-child input").attr("checked",false).prop("checked",false).enable=true});$("#"+closePremiseContainerId).click(function f(){$("#"+addPremiseContainerId).hide();$("#"+addPremiseErrorContainer).hide();$("#"+discussionSpaceId+" li:last-child input").attr("checked",false).prop("checked",false).enable=true});$("#"+closeIslandViewContainerId).click(function(){s.resetChangeDisplayStyleBox();$("#li_"+addReasonButtonId).attr("checked",true).prop("checked",true)});$("#"+closeGraphViewContainerId).click(function(){s.resetChangeDisplayStyleBox()});$("#"+editStatementButtonId).click(function(){s.showEditStatementsPopup()});$("#"+o).click(function o(){s.hideandClearEditStatementsPopup()});$("#"+c).click(function c(){s.hideandClearEditStatementsPopup()});$("#"+d).click(function d(){s.hideAndClearUrlSharingPopup()});$("#"+p).click(function p(){s.hideAndClearUrlSharingPopup()});$("#"+shareUrlId).click(function j(){s.showUrlSharingPopup()});$("#"+popupUrlSharingLongUrlButtonID).click(function(){if($(this).attr("data-is-short-url")=="0"){$("#"+popupUrlSharingInputId).val($("#"+popupUrlSharingInputId).attr("data-short-url"));$(this).attr("data-is-short-url","1").text(_t(fetchLongUrl))}else{$("#"+popupUrlSharingInputId).val(window.location);$(this).attr("data-is-short-url","0").text(_t(fetchShortUrl))}});$("#"+m).click(function m(){new Sharing().emailShare("user@example.com",_t(interestingOnDBAS),_t(haveALookAt)+" "+$("#"+popupUrlSharingInputId).val())});$("#"+i).click(function i(){new Sharing().twitterShare($("#"+popupUrlSharingInputId).val(),"")});$("#"+h).click(function h(){new Sharing().googlePlusShare($("#"+popupUrlSharingInputId).val())});$("#"+k).click(function k(){var t=$("#"+popupUrlSharingInputId).val();new Sharing().facebookShare(t,"FB Sharing",_t(haveALookAt)+" "+t,mainpage+"static/images/logo.png")});s.setDisplayStyleAsDiscussion();$("#"+displayStyleIconGuidedId).click(function a(){s.setDisplayStyleAsDiscussion()});$("#"+displayStyleIconIslandId).click(function r(){s.setDisplayStyleAsIsland()});$("#"+displayStyleIconExpertId).click(function n(){s.setDisplayStyleAsGraphView()});$("#"+reportButtonId).click(function q(){var u="Report "+new Helper().getTodayAsDate(),t="URL: "+window.location.href,w=_t(fillLine).toUpperCase(),v={content:u+"\n"+t+"\n"+w,name:$("#header_user").parent().text().replace(/\s/g,"")};new Helper().redirectInNewTabForContact(v)});$("#"+opinionBarometerImageId).show().click(function l(){new DiscussionBarometer().showBarometer()});$("#"+issueDropdownListID+" .enabled").each(function(){if($(this).children().length>0){$(this).children().click(function(){var t=$(this).attr("href"),u=_t(switchDiscussionText1)+" <strong>"+$(this).attr("value")+"</strong> "+_t(switchDiscussionText2);$(this).attr("href","#");displayConfirmationDialogWithCheckbox(_t(switchDiscussion),u,_t.keepSetting,t,true)})}});$("#"+questionBubbleId).click(function(){var w,u,v,t;t=window.location.href.split("?");w=t[0].split("/");if(t[0].indexOf("/justify/")!=-1){u=w[w.length-3]}else{u=w[w.length-1]}v=u.indexOf("?");g.getMoreInfosAboutArgument(v!=-1?u.substr(0,v):u,true)});$("#"+addTopicButtonId).click(function(){var x=$("<p>").text(_t(addTopicTitleText)),v=$("<p>").text(_t(addTopicShortText)).attr("style","margin-top: 1em;"),u=$("<input>").addClass("form-control").attr("type","text").attr("placeholder","...").attr("id","add-topic-info-input"),t=$("<input>").addClass("form-control").attr("type","text").attr("placeholder","...").attr("id","add-topic-title-input"),w=$("<div>").addClass("alert").attr("id","add-topic-error").addClass("alert-danger").attr("style","margin-top: 1em;").append($("<strong>").attr("id","add-topic-error-text").text("Error")).hide();$("#"+popupConfirmDialogId).modal("show");$("#"+popupConfirmDialogId+" h4.modal-title").text(_t(addTopic));$("#"+popupConfirmDialogId+" div.modal-body").empty().append(x).append(u).append(v).append(t).append(w);$("#"+popupConfirmDialogAcceptBtn).show().click(function(){var y=$("#add-topic-info-input").val(),z=$("#add-topic-title-input").val();new AjaxSiteHandler().sendNewIssue(y,z)});$("#"+popupConfirmDialogRefuseBtn).show().click(function(){$("#"+popupConfirmDialogId).modal("hide")})});$(".triangle-r-info").each(function(){if($(this).attr("data-votecount")>0){$(this).click(function(){var v=$(this).attr("data-type"),t=$(this).attr("data-argument-uid"),u=$(this).attr("data-statement-uid");new AjaxSiteHandler().getMoreInfosAboutOpinion(v,t,u)})}else{$(this).removeClass("triangle-r-info").addClass("triangle-r-info-nohover")}})};setKeyUpFunctions=function(a,b){$("#"+addStatementContainerMainInputId).keyup(function(){new Helper().delay(function(){var d=new Helper().escapeHtml($("#"+addStatementContainerMainInputId).val());if($("#"+discussionBubbleSpaceId).find("p:last-child").text().indexOf(_t(initialPositionInterest))!=-1){b.fuzzySearch(d,addStatementContainerMainInputId,fuzzy_start_statement,"")}else{b.fuzzySearch(d,addStatementContainerMainInputId,fuzzy_start_premise,"")}},200)});$("#"+addPremiseContainerMainInputId).keyup(function(){new Helper().delay(function(){var d=new Helper().escapeHtml($("#"+addPremiseContainerMainInputId).val());b.fuzzySearch(d,addPremiseContainerMainInputId,fuzzy_add_reason,"")},200)});$("#"+popupEditStatementTextareaId).keyup(function c(){new Helper().delay(function(){b.fuzzySearch($("#"+popupEditStatementTextareaId).val(),popupEditStatementTextareaId,fuzzy_statement_popup,$("#"+popupEditStatementContentId+" .text-hover").attr("id").substr(3));$("#"+popupEditStatementWarning).hide();$("#"+popupEditStatementWarningMessage).text("")},200)})};setStyleOptions=function(a){a.setMaxHeightForBubbleSpace();a.hideSuccessDescription();a.hideErrorDescription();$("input[type='text']").on("click",function(){$(this).select()});setNavigationSidebar(window.innerWidth)};setNavigationSidebar=function(a){if(a<992){$("#discussion-sidebar").addClass("list-inline").css("text-align","left");$("#site-navigation").addClass("list-inline").css("text-align","left").find("img").each(function(){$(this).attr("data-placement","bottom")})}else{$("#discussion-sidebar").removeClass("list-inline").css("text-align","right");$("#site-navigation").removeClass("list-inline").css("text-align","right").find("img").each(function(){$(this).attr("data-placement","left")})}$("#"+sidebarMoreButtonId).attr("data-placement",a<992?"top":"left")};setWindowOptions=function(){$(document).on({ajaxStart:function b(){setTimeout("$('body').addClass('loading')",0)},ajaxStop:function c(){setTimeout("$('body').removeClass('loading')",0)}});$("#navbar-left").empty();$(window).load(function a(){});$(window).resize(function(){setNavigationSidebar(window.innerWidth);new GuiHandler().setMaxHeightForBubbleSpace()})};setGuiOptions=function(){var o=$.fn.popover.Constructor.prototype.leave,i=$("body");$.fn.popover.Constructor.prototype.leave=function(u){var s=u instanceof this.constructor?u:$(u.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);var r,t;o.call(this,u);if(u.currentTarget){r=$(u.currentTarget).siblings(".popover");t=s.timeout;r.one("mouseenter",function(){clearTimeout(t);r.one("mouseleave",function(){$.fn.popover.Constructor.prototype.leave.call(s,s)})})}};$("#site-navigation").hide();i.popover({selector:"[data-popover]",trigger:"click hover",delay:{show:50,hide:50}}).on("inserted.bs.popover",function(){var r=$("#site-navigation").detach().show();$("#discussion-sidebar-style-menu").find(".popover-content").append(r)}).on("hide.bs.popover",function(){var r=$("#site-navigation").detach().hide();$("#discussion-sidebar-style-menu").append(r)});setDiscussionWindowHeights();if(false&&window.location.href.indexOf("/reaction/")!=-1){var m="icon-badge",b="height: 30px; width:30px; margin-right: 0.5em;",a=mainpage+"static/images/icon_discussion_",q=$("#item_undermine"),p=$("#item_support"),c=$("#item_undercut"),f=$("#item_overbid"),l=$("#item_rebut"),j=$("#item_no_opinion"),n=$("<img>").addClass(m).attr({style:b,src:a+"undermine.png",onclick:q.attr("onclick")}),k=$("<img>").addClass(m).attr({style:b,src:a+"support.png",onclick:p.attr("onclick")}),h=$("<img>").addClass(m).attr({style:b,src:a+"undercut.png",onclick:c.attr("onclick")}),e=$("<img>").addClass(m).attr({style:b,src:a+"overbid.png",onclick:f.attr("onclick")}),d=$("<img>").addClass(m).attr({style:b,src:a+"rebut.png",onclick:l.attr("onclick")}),g=$("<img>").addClass(m).attr({style:b,src:a+"no_opinion.png",onclick:j.attr("onclick")});q.hide().next().prepend(n);p.hide().next().prepend(k);c.hide().next().prepend(h);f.hide().next().prepend(e);l.hide().next().prepend(d);j.hide().next().prepend(g)}$("#"+popupLogin).on("hidden.bs.modal",function(){var r=$("#"+discussionSpaceListId).find("#item_login");if(r.length>0){r.attr("checked",false).prop("checked",false)}})};setDiscussionWindowHeights=function(){var b=$("body"),a=parseInt(b.css("font-size").replace("px",""));if($("#"+breadcrumbContainerId).height()>6*a){$("#"+breadcrumbContainerId+" .col-md-12").slimScroll({position:"right",height:5*a+"px",railVisible:true,alwaysVisible:false,start:"bottom"})}};setInputExtraOptions=function(e,d){var g=$("#"+discussionSpaceListId).find("li:last-child input"),i=[],h,b,f,j,a;h=window.location.href.split("?");h=h[0].split("/");sendStartStatement=function(){i=$("#"+addStatementContainerMainInputId).val();d.sendStatement(i,"","","","",fuzzy_start_statement)},sendStartPremise=function(){b=h[h.length-2];f=h[h.length-1]=="t";i=[];$("#"+addPremiseContainerBodyId+" input").each(function(){if($(this).val().length>0){i.push($(this).val())}});d.sendStatement(i,b,f,"","",fuzzy_start_premise)},sendArgumentsPremise=function(){i=[];$("#"+addPremiseContainerBodyId+" input").each(function(){if($(this).val().length>0){i.push($(this).val())}});var k=window.location.href.indexOf("support")!=-1?1:0;j=h[h.length-3-k];f=h[h.length-2-k]=="t";a=h[h.length-1-k];d.sendStatement(i,"",f,j,a,fuzzy_add_reason)};if(window.location.href.indexOf("/r/")!=-1){$("#"+discussionSpaceId+" label").each(function(){$(this).css("width","95%")})}$("#"+discussionSpaceId+" input").each(function(){$(this).attr("checked",false).prop("checked",false)});$("#"+sendNewStatementId).off("click").click(function(){if($(this).attr("name").indexOf("start")!=-1){sendStartStatement()}});$("#"+sendNewPremiseId).off("click").click(function(){if(g.attr("id").indexOf("start_statement")!=-1){sendStartStatement()}else{if(g.attr("id").indexOf("start_premise")!=-1){sendStartPremise()}else{if(g.attr("id").indexOf("justify_premise")!=-1){sendArgumentsPremise()}}}});var c=$("#"+discussionSpaceListId).find("input");if(c.length==1&&(c.eq(0).attr("id").indexOf("start_statement")!=-1||c.eq(0).attr("id").indexOf("start_premise")!=-1||c.eq(0).attr("id").indexOf("justify_premise")!=-1||(c.eq(0).attr("id").indexOf("login")!=-1)&&$("#link_popup_login").text().indexOf(_t(login))==-1)){c.eq(0).attr("checked",true).prop("checked",true).parent().hide()}if(g.attr("id")&&(g.attr("id").indexOf("start_statement")!=-1||g.attr("id").indexOf("start_premise")!=-1||g.attr("id").indexOf("justify_premise")!=-1||g.attr("id").indexOf("login")!=-1)){g.attr("onclick","");g.change(function(){if(g.prop("checked")){if(g.attr("id").indexOf("start_statement")!=-1){e.showAddPositionContainer();$("#"+sendNewStatementId).off("click").click(function(){sendStartStatement()})}else{if(g.attr("id").indexOf("start_premise")!=-1){e.showAddPremiseContainer();$("#"+sendNewPremiseId).off("click").click(function(){sendStartPremise()})}else{if(g.attr("id").indexOf("justify_premise")!=-1){e.showAddPremiseContainer();$("#"+sendNewPremiseId).off("click").click(function(){sendArgumentsPremise()})}else{if(g.attr("id").indexOf("login")!=-1){$("#"+popupLogin).modal("show")}}}}}})}};$(document).ready(function(){var a=new GuiHandler(),b=new AjaxSiteHandler(),c=new InteractionHandler(),d;a.setHandler(c);setStyleOptions(a);setClickFunctions(a,b);setKeyUpFunctions(a,b);setWindowOptions();setGuiOptions();setInputExtraOptions(a,c);d=$("#discussion-restart-btn").attr("onclick").substr("location.href=".length);d=d.substr(1,d.length-2);$("#"+discussionEndRestart).attr("href",d)});