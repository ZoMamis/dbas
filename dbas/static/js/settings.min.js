function HistoryHandler(){this.getUserHistoryData=function(){var a=$("#hidden_csrf_token").val();$.ajax({url:"ajax_get_user_history",method:"GET",dataType:"json",async:true,headers:{"X-CSRF-Token":a}}).done(function c(d){new HistoryHandler().getUserHistoryDataDone(d)}).fail(function b(){new HistoryHandler().getDataFail()})};this.deleteUserHistoryData=function(){var a=$("#hidden_csrf_token").val();$.ajax({url:"ajax_delete_user_history",method:"POST",dataType:"json",async:true,headers:{"X-CSRF-Token":a}}).done(function c(d){new HistoryHandler().removeUserHistoryDataDone(d)}).fail(function b(){new HistoryHandler().getDataFail()})};this.getUserHistoryDataDone=function(a){new HistoryHandler().setDataInHistoryTable(a)};this.getDataFail=function(){$("#"+historyTableSuccessId).hide();$("#"+historyTableFailureId).fadeIn("slow");$("#"+historyFailureMessageId).text(_t(internalError))};this.removeUserHistoryDataDone=function(){$("#"+historyTableSpaceId).empty();$("#"+deleteHistoryButtonId).hide();$("#"+requestHistoryButtonId).hide();$("#"+historyTableSuccessId).show();$("#"+historyTableFailureId).hide();$("#"+historySuccessMessageId).text(_t(dataRemoved))};this.setDataInHistoryTable=function(j){var a,g,c,d,k,h,e,m,b=new Helper();c=["",""];a=$("<table>");a.attr("class","table table-striped table-hover").attr("border","0").attr("style","border-collapse: separate; border-spacing: 0px;");g=$("<tr>");h=$("<thead>");e=$("<tbody>");for(d=0;d<c.length;d+=1){c[d]=$("<th>")}c[0]=$("<th>").text("#");c[1]=$("<th>").text("URL");for(d=0;d<c.length;d+=1){g.append(c[d])}h.append(g);a.append(h);var f=false;k=$.parseJSON(j);$.each(k,function l(i,n){f=true;m=b.cutTextOnChar(n.url,120,"/");c[0]=$("<td>").text(i);c[1]=$("<td>").html('<a href="'+n.url+'">'+n.text+"</a>");g=$("<tr>");for(d=0;d<c.length;d+=1){g.append(c[d])}e.append(g)});a.append(e);if(f){$("#"+historyTableSpaceId).empty().append(a);$("#"+deleteHistoryButtonId).fadeIn("slow")}else{$("#"+historyTableSpaceId).empty();$("#"+historyTableSuccessId).show();$("#"+historySuccessMessageId).text(_t(noTrackedData));$("#"+deleteHistoryButtonId).hide();$("#"+requestHistoryButtonId).hide()}}}function PasswordHandler(){var a=new RegExp("[A-Z]"),d=new RegExp("[a-z]"),c=new RegExp("[0-9]"),b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!%&@#$?_~<>+-*/",e=new RegExp("([!,%,&,@,#,$,^,*,?,_,~])");this.set_total=function(i,h,f,g){h.removeClass().addClass("col-sm-9");f.text(_t(strength)+": "+_t(veryweak)).fadeIn("slow");if(i===1){h.addClass("veryweak");f.text(_t(strength)+": "+_t(veryweak))}else{if(i===2){h.addClass("weak");f.text(_t(strength)+": "+_t(weak))}else{if(i===3){h.addClass("medium");f.text(_t(strength)+": "+_t(medium))}else{if(i>3){h.addClass("strong");f.text(_t(strength)+": "+_t(strong))}else{if(g){g.fadeOut("slow")}}}}}};this.check_strength=function(g,k,f,h){var j=0,i=g.val();if(i.length>8){j=j+1}if(a.test(i)){j=j+1}if(d.test(i)){j=j+1}if(c.test(i)){j=j+1}if(e.test(i)){j=j+1}new PasswordHandler().set_total(j,k,f,h)};this.generate_password=function(f){var g="",h=0;while(!(a.test(g)&&d.test(g)&&c.test(g)&&e.test(g))){h=0;g="";for(h;h<8;h=h+1){g+=b.charAt(Math.floor(Math.random()*b.length))}}f.val(g)}}$(function(){$("#"+requestHistoryButtonId).click(function e(){new HistoryHandler().getUserHistoryData();$("#"+historyTableSuccessId).fadeOut("slow");$("#"+historyTableFailureId).fadeOut("slow");$("#"+historyTableSpaceId).empty();$("#"+requestHistoryButtonId).val(_t(refreshHistory))});$("#"+deleteHistoryButtonId).hide().click(function a(){new HistoryHandler().deleteUserHistoryData();$("#"+historyTableSuccessId).fadeOut("slow");$("#"+historyTableFailureId).fadeOut("slow");$("#"+requestHistoryButtonId).val(_t(requestHistory))});$("#"+settingsPasswordInputId).keyup(function c(){new PasswordHandler().check_strength($("#"+settingsPasswordInputId),$("#"+settingsPasswordMeterId),$("#"+settingsPasswordStrengthId),$("#"+settingsPasswordExtrasId));if($(this).val().length>0){$("#"+settingsPasswordExtrasId).fadeIn("slow")}else{$("#"+settingsPasswordExtrasId).fadeOut("slow")}});$("#"+settingsPasswordInfoIconId).click(function d(){new GuiHandler().showGeneratePasswordPopup()});$("#"+b).click(function b(){new PasswordHandler().generate_password($("#"+passwordGeneratorOutput))});$("#"+popupPasswordGeneratorButton).click(function b(){new PasswordHandler().generate_password($("#"+popupPasswordGeneratorOutput))});$(document).on({ajaxStart:function f(){setTimeout("$('body').addClass('loading')",0)},ajaxStop:function g(){setTimeout("$('body').removeClass('loading')",0)}})});