function GuiHandler(){var a;this.setHandler=function(b){a=b};this.appendAddPremiseRow=function(){var c=$("#add-premise-container-body"),f=new Date().getTime(),i=$("<div>").attr("style","padding-bottom: 2em"),b=$("<h5>").attr("style","float:left; line-height:20px; text-align:center;").text("Because..."),h="add-premise-container-main-input-"+f,e=$("<input>").attr("id",h).attr("type","text").attr("class","form-control add-premise-container-input").attr("autocomplete","off").attr("placeholder","example: There is some reason!"),g=$("<img>").attr("class","icon-rem-premise").attr("alt","icon-rem").attr("src",mainpage+"static/images/icon_minus2.png").attr("style","height: 30px; padding-right: 0.5em;").attr("title",c.find(".icon-rem-premise").first().attr("title")),d=$("<img>").attr("class","icon-add-premise").attr("alt","icon-add").attr("src",mainpage+"static/images/icon_plus2.png").attr("style","height: 30px;").attr("title",c.find(".icon-add-premise").first().attr("title"));i.append(b).append(e).append(g).append(d);$("#"+addPremiseContainerBodyId).append(i);d.click(function(){new GuiHandler().appendAddPremiseRow();$(this).hide().prev().show()});g.click(function(){$(this).parent().remove();c.find("div").children().last().show();if(c.find("div").length==1){c.find(".icon-rem-premise").hide()}else{c.find(".icon-rem-premise").show()}});$("#"+h).keyup(function(){new Helper().delay(function(){var j=new Helper().escapeHtml($("#"+h).val());new AjaxSiteHandler().fuzzySearch(j,h,fuzzy_add_reason,"")},200)})};this.setErrorDescription=function(b){$("#"+discussionErrorDescriptionId).html(b);$("#"+discussionErrorDescriptionSpaceId).show()};this.setDisplayStyleAsDiscussion=function(){this.setImageInactive($("#"+displayStyleIconGuidedId));this.setImageActive($("#"+displayStyleIconIslandId));this.setImageActive($("#"+displayStyleIconExpertId));$("#"+islandViewContainerId).hide();$("#"+graphViewContainerId).hide();$("#"+discussionContainerId).show()};this.setDisplayStyleAsIsland=function(){this.setImageActive($("#"+displayStyleIconGuidedId));this.setImageInactive($("#"+displayStyleIconIslandId));this.setImageActive($("#"+displayStyleIconExpertId));$("#"+islandViewContainerId).fadeIn("slow");$("#"+graphViewContainerId).hide()};this.setDisplayStyleAsGraphView=function(){this.setImageActive($("#"+displayStyleIconGuidedId));this.setImageActive($("#"+displayStyleIconIslandId));this.setImageInactive($("#"+displayStyleIconExpertId));$("#"+islandViewContainerId).hide();$("#"+discussionContainerId).hide();new GuiHandler().hideDiscussionError();new DiscussionGraph().showGraph()};this.setImageInactive=function(b){b.addClass("inactive-image")};this.setImageActive=function(b){b.removeClass("inactive-image")};this.showAddPositionContainer=function(){$("#"+addStatementContainerId).show()};this.showAddPremiseContainer=function(){$("#"+addPremiseContainerId).show()};this.showSetStatementContainer=function(h,s,r,b,d,g,t){var q=new GuiHandler(),c,p,j=$("#"+popupSetPremiseGroupsBodyContent).empty(),k=$("#"+popupSetPremiseGroupsPreviousButton).hide(),l=$("#"+popupSetPremiseGroupsNextButton).hide(),f=$("#"+popupSetPremiseGroupsSendButton).addClass("disabled"),i=$("#"+popupSetPremiseGroupsCounter).hide(),n="insert_statements_page_";f.click(function e(){var w=j.find("input:checked"),v,u,x;for(v=0;v<h.length;v++){x=h[v].split(" "+_t(and)+" ");if(w[v].id.indexOf(attr_more_args)!=-1){for(u=0;u<x.length;u++){s.push([x[u]])}}else{if(w[v].id.indexOf(attr_one_arg)!=-1){s.push(x)}else{s.push([h[v]])}}}if(b==fuzzy_add_reason){new AjaxSiteHandler().sendNewPremiseForArgument(d,g,s)}else{if(b==fuzzy_start_premise){new AjaxSiteHandler().sendNewStartPremise(s,t,r)}else{alert("Todo: unknown type")}}$("#"+popupSetPremiseGroups).modal("hide")});if(h.length==1){c=q.getPageOfSetStatementContainer(0,h[0],r);j.append(c);c.find("input").each(function(){$(this).click(function u(){f.removeClass("disabled")})})}else{k.show().removeClass("href").attr("max",h.length).parent().addClass("disabled");l.show().attr("max",h.length);i.show().text("1/"+h.length);for(p=0;p<h.length;p++){c=q.getPageOfSetStatementContainer(p,h[p],r);if(p>0){c.hide()}j.append(c);c.find("input").each(function(){$(this).click(function u(){new GuiHandler().displayNextPageOffSetStatementContainer(j,k,l,i,n)})})}k.click(function m(){new GuiHandler().displayPrevPageOffSetStatementContainer(j,k,l,i,n)});l.click(function o(){new GuiHandler().displayNextPageOffSetStatementContainer(j,k,l,i,n)})}$("#"+popupSetPremiseGroups).modal("show")};this.displayNextPageOffSetStatementContainer=function(c,f,e,b,h){var g=c.find("div:visible"),i=parseInt(g.attr("id").substr(h.length)),d=g.find("input:checked");if(d.length==0){$("#insert_statements_page_error").fadeIn()}else{$("#insert_statements_page_error").fadeOut();if(i<(parseInt(e.attr("max"))-1)){g.hide().next().fadeIn();f.parent().removeClass("disabled");b.show().text((i+2)+"/"+e.attr("max"));if((i+2)==parseInt(e.attr("max"))){e.parent().addClass("disabled")}}else{$("#"+popupSetPremiseGroupsSendButton).removeClass("disabled")}}};this.displayPrevPageOffSetStatementContainer=function(c,e,d,b,g){var f=c.find("div:visible"),h=parseInt(f.attr("id").substr(g.length));if(h>0){f.hide().prev().fadeIn();d.parent().removeClass("disabled");b.show().text((h)+"/"+e.attr("max"));if(h==0){e.parent().addClass("disabled")}}};this.getPageOfSetStatementContainer=function(q,r,p){var b=$("#insert_statements_page_"),n=b.clone(),d=b.attr("id"),m=r.split(" "+_t(and)+" "),j=$("#"+addPremiseContainerMainInputIntroId).text(),g,f,e,l,k,o,c,h;if(j.match(/\.$/)){j=j.substr(0,j.length-1)+", "}n.attr("id",d+q).attr("page",q).show();n.find("#"+popupSetPremiseGroupsStatementCount).text(m.length);l=n.find("#"+popupSetPremiseGroupsListMoreArguments);o=n.find("#"+popupSetPremiseGroupsOneBigStatement);g=n.find("#insert_more_arguments");f=n.find("#insert_one_argument");e=n.find("#insert_dont_care");g.attr("id",g.attr("id")+"_"+q);f.attr("id",f.attr("id")+"_"+q);e.attr("id",e.attr("id")+"_"+q);g.attr("name",g.attr("name")+"_"+q);f.attr("name",f.attr("name")+"_"+q);e.attr("name",e.attr("name")+"_"+q);g.parent().attr("for",g.parent().attr("for")+"_"+q);f.parent().attr("for",f.parent().attr("for")+"_"+q);e.parent().attr("for",e.parent().attr("for")+"_"+q);c=p?_t(itIsTrueThat):_t(itIsFalseThat);k=j+" "+_t(because)+" "+c;for(h=0;h<m.length;h++){l.append($("<li>").text(j+" "+_t(because)+" "+m[h]+"."));k+=" "+h==0?" "+m[h]:(" "+_t(andAtTheSameTime)+" "+c+" "+m[h])}o.text(k+".");return n};this.setStatementsAsProposal=function(m,l,k){var j=$("#"+l),i;if(k==fuzzy_start_premise){$("#"+proposalPremiseListGroupId).empty()}else{if(k==fuzzy_start_statement){$("#"+proposalStatementListGroupId).empty()}else{if(k==fuzzy_add_reason){$("#"+proposalPremiseListGroupId).empty()}else{if(k==fuzzy_statement_popup){$("#"+proposalEditListGroupId).empty()}}}}if(Object.keys(m).length==0){return}var d,c,f,e,h,b,g;j.focus();$.each(m.values,function(n,o){d=n.split("_");b=parseInt(d[0]);g=d[1];c=j.val();i=o;o="<b>"+o.replace(c,"</b>"+c+"<b>").replace(c.toLocaleLowerCase(),"</b>"+c.toLocaleLowerCase()+"<b>")+"</b>";f=$("<button>").attr("type","button").attr("class ","list-group-item").attr("id","proposal_"+g).attr("text",i).hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});e=$("<span>").attr("class","badge").text(m.distance_name+" "+b);h=$("<span>").attr("id","proposal_"+g+"_text").html(o);f.append(e).append(h).click(function(){j.val($(this).attr("text"));$("#"+proposalStatementListGroupId).empty();$("#"+proposalPremiseListGroupId).empty();$("#"+proposalEditListGroupId).empty()});if(k==fuzzy_start_premise){$("#"+proposalPremiseListGroupId).append(f)}else{if(k==fuzzy_start_statement){$("#"+proposalStatementListGroupId).append(f)}else{if(k==fuzzy_add_reason){$("#"+proposalPremiseListGroupId).append(f)}else{if(k==fuzzy_statement_popup){$("#"+proposalEditListGroupId).append(f)}}}}})};this.showDiscussionError=function(b){$("#"+discussionFailureRowId).fadeIn("slow");$("#"+discussionFailureMsgId).html(b);$("#"+contactOnErrorId).click(function(){var d="Report "+new Helper().getTodayAsDate(),c="URL: "+window.location.href,f=_t(fillLine).toUpperCase(),e={content:d+"\n"+c+"\n"+f,name:$("#header_user").parent().text().replace(/\s/g,"")};new Helper().redirectInNewTabForContact(e)})};this.showEditStatementsPopup=function(){var d,f,c,e,b=new Helper();$("#"+popupEditStatementId).modal("show");$("#"+popupEditStatementWarning).hide();d=$("<table>").attr("class","table table-condensed").attr("border","0").attr("style","border-collapse: separate; border-spacing: 5px 5px;");c=$("<td>").html("<strong>"+_t(text)+"</strong>").css("text-align","center");e=$("<td>").html("<strong>"+_t(options)+"</strong>").css("text-align","right");d.append($("<tr>").append(c).append(e));$("#"+discussionSpaceId+" li:not(:last-child) label:nth-child(even)").each(function(){f=b.createRowInEditDialog($(this).text(),$(this).attr("for").substr("item_".length),$(this).attr("id"));d.append(f)});$("#"+popupEditStatementContentId).empty().append(d);$("#"+popupEditStatementTextareaId).hide();$("#"+popupEditStatementDescriptionId).hide();$("#"+popupEditStatementSubmitButtonId).hide();$("#"+proposalEditListGroupId).empty()};this.showUrlSharingPopup=function(){$("#"+popupUrlSharingId).modal("show");new AjaxSiteHandler().getShortenUrl(window.location)};this.showGeneratePasswordPopup=function(){$("#"+popupGeneratePasswordId).modal("show");$("#"+popupGeneratePasswordCloseButtonId).click(function(){$("#"+popupGeneratePasswordId).modal("hide")});$("#"+popupLoginCloseButton).click(function(){$("#"+popupGeneratePasswordId).modal("hide")})};this.showEditFieldsInEditPopup=function(){$("#"+popupEditStatementSubmitButtonId).fadeIn("slow");$("#"+popupEditStatementTextareaId).fadeIn("slow");$("#"+popupEditStatementDescriptionId).fadeIn("slow")};this.showStatementCorrectionsInPopup=function(d){var f,h,e,b,c;f=$("<table>");f.attr("id","edit_statement_table").attr("class","table table-condensed").attr("border","0").attr("style","border-collapse: separate; border-spacing: 5px 5px;");h=$("<tr>");b=$("<td>");e=$("<td>");c=$("<td>");b.html("<b>Date</b>").css("text-align","center");e.html("<b>Text</b>").css("text-align","center");c.html("<b>Author</b>").css("text-align","center");h.append(b);h.append(e);h.append(c);f.append(h);$.each(d.content,function g(i,j){h=$("<tr>");b=$("<td>");e=$("<td>");c=$("<td>");b.text(j.date);e.text(j.text);c.text(j.author);h.append(b);h.append(e);h.append(c);f.append(h)});$("#"+popupEditStatementLogfileSpaceId).empty().append(f)};this.showHowToWriteTextPopup=function(){var c="HOW_TO_WRITE_TEXT",b=new Helper().isCookieSet(c);if(!b){$("#"+popupHowToWriteText).modal("show")}$("#"+popupHowToWriteTextOkayButton).click(function(){$("#"+popupHowToWriteText).modal("hide");new Helper().setCookie(c)})};this.hideEditFieldsInEditPopup=function(){$("#"+popupEditStatementSubmitButtonId).hide();$("#"+popupEditStatementTextareaId).hide();$("#"+popupEditStatementDescriptionId).hide()};this.hideLogfileInEditPopup=function(){$("#"+popupEditStatementLogfileSpaceId).empty();$("#"+popupEditStatementLogfileHeaderId).html("")};this.hideandClearEditStatementsPopup=function(){$("#"+popupEditStatementId).modal("hide");$("#"+popupEditStatementContentId).empty();$("#"+popupEditStatementLogfileSpaceId).text("");$("#"+popupEditStatementLogfileHeaderId).text("");$("#"+popupEditStatementTextareaId).text("");$("#"+popupEditStatementErrorDescriptionId).text("");$("#"+popupEditStatementSuccessDescriptionId).text("")};this.hideAndClearUrlSharingPopup=function(){$("#"+popupUrlSharingId).modal("hide");$("#"+popupUrlSharingInputId).val("")};this.hideErrorDescription=function(){$("#"+discussionErrorDescriptionId).html("");$("#"+discussionErrorDescriptionSpaceId).hide()};this.hideSuccessDescription=function(){$("#"+discussionSuccessDescriptionId).html("");$("#"+discussionSuccessDescriptionSpaceId).hide()};this.hideDiscussionError=function(){$("#"+discussionFailureRowId).hide()};this.hideDiscussionDescriptionsNextElement=function(){$("#"+discussionsDescriptionId).attr("style","margin-bottom: 0px;").parent().parent().next().hide()};this.updateOfStatementInDiscussion=function(b){$("#td_"+b.uid).text(b.text);$("#"+b.uid).text(b.text)};this.resetChangeDisplayStyleBox=function(){this.setDisplayStyleAsDiscussion()};this.resetEditAndRefactorButton=function(e){if(typeof e==="undefined"){e=true}var g=false,d,b,f,c;$("#"+discussionSpaceId+" ul > li").children().each(function(){d=$(this).val();b=$(this).attr("id");f=$(this).hasClass("premise");c=$(this).hasClass("start");if(e){if($(this).prop("tagName").toLowerCase().indexOf("input")>-1&&d.length>0&&$.isNumeric(b)||f||c){g=true;return false}}});if(g){$("#"+editStatementButtonId).show();$("#"+reportButtonId).show()}else{$("#"+editStatementButtonId).hide();$("#"+reportButtonId).hide()}}};