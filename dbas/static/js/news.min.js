function News(){var a=990;this.getNewsContainerAsHtml=function(f,b,d,c,e){return'<div class="col-md-4"><div class="panel panel-default"><div class="panel-heading" id="news_'+e+'"><a class="share-icon-small share-mail-small"></a><a class="share-icon-small share-twitter-small"></a><a class="share-icon-small share-google-small"></a><a class="share-icon-small share-facebook-small"></a><h5><span class="font-semi-bold" id="news_'+e+'_title">'+f+'</span></h5></div><div class="panel-body"><h6><span id="news_'+e+'_author">'+d+'</span>, <span id="news_'+e+'_date">'+b+"</span></h6><br>"+c+"</div></div></div>"};this.ajaxGetNews=function(){$.ajax({url:"ajax_get_news",type:"POST",dataType:"json",async:true}).done(function c(d){new News().callbackIfDoneForGettingNews(d)}).fail(function b(){$("#"+newsBodyId).append("<h4>"+internalError+"</h4>")})};this.ajaxSendNews=function(){var e=$("#"+writingNewNewsTitleId).val(),d=$("#"+writingNewNewsTextId).val();if(e.length==0||d.length<10){$("#"+writingNewsFailedId).show();$("#"+writingNewsFailedMessageId).text(_t(empty_news_input));return}else{$("#"+writingNewsFailedId).hide();$("#"+writingNewsSuccessId).hide()}$.ajax({url:"ajax_send_news",type:"POST",data:{title:e,text:d},dataType:"json",async:true}).done(function c(f){new News().callbackIfDoneForSendingNews(f)}).fail(function b(){$("#"+writingNewsFailedId).show();$("#"+writingNewsFailedMessageId).text(_t(internalError))})};this.callbackIfDoneForGettingNews=function(g){var k=$.parseJSON(g),b=1,d="",l=0,e,f=Object.keys(k).length,h=new Array(f),c="",i=new News();$.each(k,function j(m,n){h[f-b]=i.getNewsContainerAsHtml(n.title,n.date,n.author,n.news,n.uid);b+=1});b=0;for(b=0;b<f;b++){if(b%3==0){if(d!==""){$("#"+newsBodyId).append(c)}d=$("<div>").attr("id","row_"+l).addClass("row");c=$("<div>").attr("id","container_"+l).addClass("container");l+=1}d.append(h[b]);c.append(d)}f=c.children().eq(0).children().length;$.each(c.children().eq(0).children(),function(){$(this).attr("class","").attr("class","col-md-"+(12/f))});b-=1;if(b%3!=0){$("#"+newsBodyId).append(c)}i.setMaxHeightOfNewsRows();i.setPageNavigation();i.setSharingClasses()};this.callbackIfDoneForSendingNews=function(b){var c=$.parseJSON(b);if(c.error.length==0){$("#"+writingNewsSuccessId).show();$("#"+writingNewsSuccessMessageId).text(_t(addedEverything));$("#"+writingNewNewsTitleId).val("");$("#"+writingNewNewsTextId).val("");$("#"+newsBodyId).prepend(new News().getNewsContainerAsHtml(c.title,c.date,c.author,c.news));new News().setSharingClasses();window.scrollTo(0,0)}else{$("#"+writingNewsFailedId).show();$("#"+writingNewsFailedMessageId).text(c.error)}};this.setMaxHeightOfNewsRows=function(){var b,e=$("#"+newsBodyId).children().length,d,c;if($(window).width()<a){return}for(b=0;b<e;b++){d=$("#row_"+b+" div").children(":first-child").map(function(){return $(this).height()}).get();c=Math.max.apply(null,d);$.each($("#row_"+b).children(),function(){$(this).children().eq(0).height(c)})}};this.setPageNavigation=function(){var b,k=$("#"+newsBodyId).children().length,g=2,j=this,d=1,f=$("#news-navigation"),i,h,c,e="";f.empty();for(b=0;b<k;b++){if(b!=0&&b%g==0){d++}$("#container_"+b).addClass("news-page-"+d).hide()}h='<li><a href="#" id="news-back"><span aria-hidden="true">&laquo;</span></a></li>';for(b=1;b<=d;b++){e+='<li><a href="#" counter="'+b+'" id="news-'+b+'">'+b+"</a></li>"}c='<li><a href="#" id="news-forth"><span aria-hidden="true">&raquo;</span></a></li>';i='<ul class="pagination">'+h+e+c+"</ul>";f.append(i);for(b=0;b<=d;b++){$("#news-"+(b+1)).click(function(){$("#news-navigation").children().eq(0).children().removeClass("active");$(this).parent().addClass("active");$("#"+newsBodyId).children().hide();$(".news-page-"+$(this).attr("counter")).show();j.checkNewsForthAndBackButtons($(this).attr("counter"),d)})}$("#news-1").parent().addClass("active");$(".news-page-1").show();$("#news-back").parent().addClass("disabled");j.setPlaceholder($("#news-1").attr("counter"),d);$(".pagination a").click(function(){if(!$(this).hasClass("news-placeholder")){j.setPlaceholder($(this).attr("counter"),d)}});$("#news-back").off("click").click(function(){if(!$(this).parent().hasClass("disabled")){j.turnThePage(true,d)}}).hide();$("#news-forth").off("click").click(function(){if(!$(this).parent().hasClass("disabled")){j.turnThePage(false,d)}}).hide()};this.setPlaceholder=function(b,d){var c,f,e,g=$("<li>").addClass("disabled").append($("<a>").addClass("news-placeholder").text("..."));$(".news-placeholder").remove();for(c=3;c<d-1;c++){$("#news-"+c).parent().hide()}f=b-1;c=f+1;e=c+1;$("#news-"+f).parent().show();$("#news-"+c).parent().show();$("#news-"+e).parent().show();if(f-3>0){g.insertAfter($("#news-"+(f-1)).parent())}if(d-2-e>0){g.insertAfter($("#news-"+e).parent())}};this.turnThePage=function(c,d){var e=$("#news-navigation .active"),b=parseInt(e.children().eq(0).attr("counter"));e.removeClass("active");if(c){e.prev().addClass("active")}else{e.next().addClass("active")}$(".news-page-"+b).hide();b=c?b-1:b+1;$(".news-page-"+b).show();this.checkNewsForthAndBackButtons(b,d);this.setPlaceholder(b,d)};this.checkNewsForthAndBackButtons=function(c,b){if(c==0){$("#news-back").parent().addClass("disabled")}else{$("#news-back").parent().removeClass("disabled")}if(c==b){$("#news-forth").parent().addClass("disabled")}else{$("#news-forth").parent().removeClass("disabled")}};this.setSharingClasses=function(){var b=new News();$("."+shareButtonMail).click(function(){b.mailShare(this)});$("."+shareButtonMailSmall).click(function(){b.mailShare(this)});$("."+shareButtonTwitter).click(function(){b.twitterShare(this)});$("."+shareButtonTwitterSmall).click(function(){b.twitterShare(this)});$("."+shareButtonGoogle).click(function(){b.googleShare(this)});$("."+shareButtonGoogleSmall).click(function(){b.googleShare(this)});$("."+shareButtonFacebook).click(function(){b.facebookShare(this)});$("."+shareButtonFacebookSmall).click(function(){b.facebookShare(this)})};this.mailShare=function(f){if($(f).attr("id")===shareUrlButtonMail){return}var e=$(f).parent().attr("id"),d=$("#"+e+"_title").text(),b=$("#"+e+"_date").text(),c=$("#"+e+"_author").text();new Sharing().emailShare("user@example.com","DBAS: "+d,"Interesting news from "+b+", by "+c+" - "+window.location.href)};this.googleShare=function(b){if($(b).attr("id")===shareUrlButtonGoogle){return}new Sharing().googlePlusShare(window.location.href)};this.facebookShare=function(g){if($(g).attr("id")===shareUrlButtonFacebook){return}var f=$(g).parent().attr("id"),e=$("#"+f+"_title").text(),b=$("#"+f+"_date").text(),c=$("#"+f+"_author").text(),d="News '"+e+"', from "+b+", by "+c+" on "+window.location.href;new Sharing().facebookShare(window.location.href,"FB Sharing",d,mainpage+"static/images/logo.png")};this.twitterShare=function(d){if($(d).attr("id")===shareUrlButtonTwitter){return}var c=$(d).parent().attr("id"),b=$("#"+c+"_title").text();new Sharing().twitterShare(b,window.location.href)}}$(document).ready(function(){var a=new News();a.ajaxGetNews();$("#"+writingNewsFailedId).hide();$("#"+writingNewsSuccessId).hide();a.setSharingClasses();$("#"+sendNewsButtonId).click(function(){a.ajaxSendNews()});$(window).on("resize",function b(){a.setMaxHeightOfNewsRows()})});