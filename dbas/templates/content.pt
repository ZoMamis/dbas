<tal:block metal:use-macro="layout" i18n:domain="dbas" metal:define-macro="layout">
    <tal:block metal:fill-slot="content_page">

        <div class="container colored-container" id="header-container">
            <div class="row cn">
                <div class="col-md-8 center">
                    <span>${structure:issues.intro}</span>:<br>
                    <span class="lead" id="issue_info" data-discussion-language="" tal:attributes="data-discussion-language extras.tag.language">${structure:issues.info}</span>
                    <i id="issue-info" class="fa fa-info-circle" aria-hidden="true" data-toggle="tooltip" data-placement="auto" tal:attributes="data-original-title issues.tooltip"></i>
                </div>
                <div class="col-md-2 center inner">
                    <div class="dropdown">
                        <button class="btn btn-primary dropdown-toggle btn-sm" type="button" id="issue-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" tal:attributes="issue issues.uid">
                            <span i18n:translate="switch_topc">Switch Topic</span>&#160;&#160;<span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" id="dropdown-issue-list" aria-labelledby="issue-dropdown" style="width: 280px;">
                            <li tal:repeat="issue issues.all" tal:attributes="class issue.enabled">
                                <a href="#" tal:attributes="href issue.url; value issue.title">
                                <div class="row" style="padding: 0;">
                                    <div class="col-md-10" style="white-space: pre-wrap;">${structure:issue.title}</div>
                                    <div class="col-md-2">
                                        <span class="badge" data-toggle="tooltip" data-placement="bottom" tal:attributes="title extras.buttons.count_of_posts">${issue.stat_count}
                                        </span>
                                    </div>
                                </div>
                                </a>
                            </li>
                            <li tal:condition="extras.is_admin or extras.is_author" role="separator" class="divider"></li>
                            <li tal:condition="extras.is_admin or extras.is_author" role="separator">
                                <a id="add-topic" href="#" i18n:translate="add_topic">Add a Topic</a>
                            </li>
                        </ul>
                    </div>
                 </div>
                <div class="col-md-2 center inner">
                    <button id="discussion-restart-btn" class="btn btn-primary btn-sm" data-dismiss="modal" type="button" onclick="" tal:attributes="onclick extras.restart_url">
                        <span i18n:translate="restart_discussion">Restart</span>&#160;&#160;<span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                    </button>
                </div>
            </div>
        </div>

        <div class="container colored-container" id="discussion-container">
            <div id="dialog-wrapper" class="content-wrapper pull-left">

                <div id="discussion-error-description-space" class="alert alert-danger alert-dismissible hidden">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <span id="discussion-error-description"></span>
                </div>

                <div id="discussion-success-description-space" class="alert alert-success alert-dismissible hidden">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <strong i18n:translate="success">Success</strong>
                    <span id="discussion-success-description"></span>
                </div>

                 <div id="dialog-speech-bubbles-space">
                        <div tal:repeat="bubble discussion.bubbles" tal:omit-tag="">
                            <div tal:condition="bubble.is_user" class="line-wrapper-r">
                                <p class="triangle-r" tal:attributes="id bubble.id">
                                    <!--<img class="triangle-gravatar-r" tal:attributes="src extras.users_avatar">-->
                                    <a tal:omit-tag="bubble.omit_url" tal:attributes="href bubble.url; title extras.buttons.lets_go_back" data-toggle="tooltip" data-placement="bottom">
                                        <span>${structure:bubble.message}</span>
                                    </a>
                                    <br>
                                    <em class="triangle-r-info" tal:attributes="data-type bubble.data_type; data-argument-uid bubble.data_argument_uid; data-statement-uid bubble.data_statement_uid; data-votecount bubble.votecounts; data-is-supportive bubble.data_is_supportive">${bubble.votecounts_message}</em>
                                </p>
                            </div>
                            <div tal:condition="bubble.is_system" class="line-wrapper-l">
                                <p class="triangle-l" tal:attributes="id bubble.id">
                                    <!--<img class="triangle-gravatar-l"  tal:attributes="src extras.users_avatar">-->
                                    <a tal:omit-tag="bubble.omit_url" tal:attributes="href bubble.url; title extras.buttons.lets_go_back" data-toggle="tooltip" data-placement="bottom">
                                            ${structure:bubble.message}
                                    </a>
                                </p>
                            </div>
                            <div tal:condition="bubble.is_status" class="line-wrapper-m">
                                <p class="triangle-m" tal:attributes="id bubble.id">${structure:bubble.message}</p>
                            </div>
                            <div tal:condition="bubble.is_info" class="line-wrapper-m">
                                <p class="triangle-m-info" tal:attributes="id bubble.id">${structure:bubble.message}</p>
                            </div>
                       </div>
                    </div>
                <div id="discussions-space">
                    <ul id="discussions-space-list">
                        <li tal:repeat="item items">
                            <input id="tmp" type="radio" name="discussion-button-group" onclick="" tal:attributes="id item.id; onclick item.url">
                            <span tal:repeat="premise item.premises" tal:omit-tag="">
                                   <label for="tmp" tal:attributes="for item.id; id premise.id" data-toggle="tooltip" data-placement="auto">${structure:premise.title}</label>
                                   <label tal:attributes="for item.id" tal:condition="not:repeat.premise.end"><em>${extras.tag.aand}</em></label>
                                   <label tal:condition="repeat.premise.end and item.already_used"><em>${item.already_used_text}</em></label>
                               </span>
                        </li>
                    </ul>
                       <!--
                       <div id="discussion-space-answer-buttons" class="center" tal:condition="extras.show_island_icon">
                           <a tal:attributes="id items[0].id; href items[0].url; title items[0].premises[0].title" data-toggle="tooltip" data-placement="top"><img class="icon-badge" style="width: 7%; margin: 0 1em 0 1em; cursor: hand" src="${request.static_url('dbas:static/images/rect_attack.svg')}"></a>
                           <a tal:attributes="id items[1].id; href items[1].url; title items[1].premises[0].title" data-toggle="tooltip" data-placement="top"><img class="icon-badge" style="width: 7%; margin: 0 1em 0 1em; cursor: hand" src="${request.static_url('dbas:static/images/rect_support.svg')}"></a>
                           <a tal:attributes="id items[2].id; href items[2].url; title items[2].premises[0].title" data-toggle="tooltip" data-placement="top"><img class="icon-badge" style="width: 7%; margin: 0 1em 0 1em; cursor: hand" src="${request.static_url('dbas:static/images/rect_undercut.svg')}"></a>
                           <a tal:attributes="id items[3].id; href items[3].url; title items[3].premises[0].title" data-toggle="tooltip" data-placement="top"><img class="icon-badge" style="width: 7%; margin: 0 1em 0 1em; cursor: hand" src="${request.static_url('dbas:static/images/rect_rebut.svg')}"></a>
                           <a tal:condition="items[4].id == 'item_no_opinion'" tal:attributes="id items[4].id; href items[4].url; title items[4].premises[0].title" data-toggle="tooltip" data-placement="top"><img class="icon-badge" style="width: 7%; margin: 0 1em 0 1em; cursor: hand" src="${request.static_url('dbas:static/images/rect_dontknow.svg')}"></a>
                           <a href="javascript:window.history.back();" data-toggle="tooltip" data-placement="top" tal:attributes="title extras.buttons.go_back"><img class="icon-badge" style="width: 7%; margin: 0 1em 0 1em; cursor: hand" src="${request.static_url('dbas:static/images/rect_back.svg')}"></a>
                       </div>
                       -->
                </div>
            </div>

            <div class="pull-right sidebar-wrapper">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>

                <ul class="sidebar">
                    <li id="share-url"><i class="fa fa-share" aria-hidden="true" tal:attributes="titel extras.buttons.share_url"></i><span class="sidebar-element">${extras.buttons.share_url}</span></li>
                    <li id="edit-statement" tal:condition="extras.is_editable"><i class="fa fa-pencil-square-o" aria-hidden="true" tal:attributes="titel extras.buttons.edit_statement"></i><span class="sidebar-element">${extras.buttons.edit_statement}</span></li>
                    <li id="report-button" tal:condition="extras.is_reportable"><i class="fa fa-flag" aria-hidden="true" tal:attributes="titel extras.title.report_title"></i><span class="sidebar-element">${extras.title.report_title}</span></li>
                    <li id="opinion-barometer-img" tal:condition="extras.show_bar_icon"><i class="fa fa-bar-chart" aria-hidden="true" tal:attributes="titel extras.title.barometer"></i><span class="sidebar-element">${extras.title.barometer}</span></li>
                    <li id="display-style-icon-island-img" tal:condition="extras.show_island_icon"><i class="fa fa-map-o" aria-hidden="true" tal:attributes="titel extras.title.island_view"></i><span class="sidebar-element">${extras.title.island_view}</span></li>
                    <li id="display-style-icon-expert-img" tal:condition="extras.show_expert_icon"><i class="fa fa-graduation-cap" aria-hidden="true" tal:attributes="titel extras.title.expert_view"></i><span class="sidebar-element">${extras.title.expert_view}</span></li>
                    <li onclick="window.location='/discuss/finish'" id="finish-button"><i class="fa fa-sign-out" aria-hidden="true" tal:attributes="titel extras.title.finish_title"></i><span class="sidebar-element">${extras.title.finish_title}</span></li>
                </ul>

                <div class="tack-wrapper" data-toggle="tooltip" data-placement="bottom">
                    <i class="tack fa fa-thumb-tack" aria-hidden="true"></i>
                </div>
            </div>

            <div class="hidden">
                <div class="col-md-12 center">
                    <img class="glyphicon-local navigation-icon" id="navigation-back" src="${request.static_url('dbas:static/images/transparent.gif')}"  tal:attributes="title extras.buttons.go_back"/>
                    <img class="glyphicon-local navigation-icon" id="navigation-forward" src="${request.static_url('dbas:static/images/transparent.gif')}"  tal:attributes="title extras.buttons.go_forward"/>
                </div>
            </div>
        </div>

        <div class="container colored-container" id="island-view-container" style="display:none" tal:condition="extras.show_island_icon">
            <button id="close-island-view-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="row" id="island-view-container-space">
            <div class="row">
                <div class="col-md-11 text-center">
                    <h4><span i18n:translate="island_view_for">${structure:extras.tag.island_view_for}</span>: <span id="island-view-container-space-heading">${structure:extras.island.heading}</span></h4>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                       <div class="bs-callout bs-callout-danger">
                           <h4>
                               <span class="text-danger">&#10008;</span>
                               <span class="lead">${structure:extras.island.undermine_text}</span>
                           </h4>
                           <div>
                            <ul>
                                <li tal:repeat="undermine extras.island.undermine" tal:attributes="id undermine.id">
                                    <label tal:attributes="for undermine.id">${structure:undermine.text}</label>
                                </li>
                            </ul>
                            <button id="island-view-undermine-button" type="button" class="btn btn-primary" data-dismiss="modal" style="float: right;">${extras.buttons.resume_here}</button>
                           </div>
                       </div>
                </div>

                   <div class="col-md-6">
                       <div class="bs-callout bs-callout-success">
                           <h4>
                               <span class="text-success">&#10004;</span>
                               <span class="lead">${structure:extras.island.support_text}</span>
                           </h4>
                           <div>
                            <ul>
                                <li tal:repeat="support extras.island.support" tal:attributes="id support.id">
                                    <label tal:attributes="for support.id">${structure:support.text}</label>
                                </li>
                            </ul>
                            <button id="island-view-support-button" type="button" class="btn btn-primary" data-dismiss="modal" style="float: right;">${extras.buttons.resume_here}</button>
                           </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                       <div class="bs-callout bs-callout-info">
                           <h4>
                               <span class="text-info">&#10134</span>
                               <span class="lead">${structure:extras.island.undercut_text}</span>
                           </h4>
                           <div>
                            <ul>
                                <li tal:repeat="undercut extras.island.undercut" tal:attributes="id undercut.id">
                                    <label tal:attributes="for undercut.id">${structure:undercut.text}</label>
                                </li>
                            </ul>
                            <button id="island-view-undercut-button" type="button" class="btn btn-primary" data-dismiss="modal" style="float: right;">${extras.buttons.resume_here}</button>
                           </div>
                    </div>
                </div>

                <div class="col-md-6">
                       <div class="bs-callout bs-callout-info">
                           <h4>
                               <span class="text-info">&#10134;</span>
                               <span class="lead">${structure:extras.island.rebut_text}</span>
                           </h4>
                           <div>
                            <ul>
                                <li tal:repeat="rebut extras.island.rebut" tal:attributes="id rebut.id">
                                    <label tal:attributes="for rebut.id">${structure:rebut.text}</label>
                                </li>
                            </ul>
                            <button id="island-view-rebut-button" type="button" class="btn btn-primary" data-dismiss="modal" style="float: right;">${extras.buttons.resume_here}</button>
                           </div>
                    </div>
                </div>
            </div>

            </div>
        </div>

        <div class="colored-container" id="graph-view-container" style="display:none">
            <div class="pull-left content-wrapper">
                <button id="close-graph-view-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 id="graph-view-container-header" class="center"></h4>
                <div id="graph-view-container-space" style="height:95%;">
                </div>
            </div>

            <div class="pull-right sidebar-wrapper">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>

                <ul class="sidebar">
                    <li id="start-view"><i class="fa fa-play" aria-hidden="true" tal:attributes="titel extras.buttons.default_view"></i><span class="sidebar-element">${extras.buttons.default_view}</span></li>
                    <li id="show-content"><i class="fa fa-eye" aria-hidden="true" tal:attributes="titel extras.buttons.show_content"></i><span class="sidebar-element">${extras.buttons.show_content}</span></li>
                    <li id="hide-content"><i class="fa fa-eye-slash" aria-hidden="true" tal:attributes="titel extras.buttons.hide_content"></i><span class="sidebar-element">${extras.buttons.hide_content}</span></li>
                    <li id="show-positions"><i class="fa fa-eye" aria-hidden="true" tal:attributes="titel extras.buttons.show_positions"></i><span class="sidebar-element">${extras.buttons.show_positions}</span></li>
                    <li id="hide-positions"><i class="fa fa-eye-slash" aria-hidden="true" tal:attributes="titel extras.buttons.hide_positions"></i><span class="sidebar-element">${extras.buttons.hide_positions}</span></li>
                    <li id="snapshot-graph"><i class="fa fa-camera" aria-hidden="true" tal:attributes="titel extras.buttons.snapshot_graph"></i><span class="sidebar-element">${extras.buttons.snapshot_graph}</span></li>
                </ul>

                <div class="tack-wrapper" data-toggle="tooltip" data-placement="bottom">
                    <i class="tack fa fa-thumb-tack" aria-hidden="true"></i>
                </div>
            </div>
        </div>

        <div class="container colored-container" id="add-statement-container" style="display:none" tal:attributes="style extras.add_statement_container_style">
            <button tal:condition="extras.close_statement_container" id="close-statement-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <br>
            <div class="col-md-12 text-center">
                <h5>${structure:discussion.add_premise_text}</h5>
                <div id="add-statement-error-container" class="alert alert-danger" role="alert" style="display:none">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    <span id="add-statement-error-msg"></span>
                </div>
                <div id="add-statement-container-body">
                    <input id="add-statement-container-main-input" type="text" class="add-statement-container-input form-control" name="" autocomplete="off" placeholder="..." value="" data-min-length="10"  data-max-length="140">
                </div>
                <div class="list-group" id="proposal-statement-list-group"></div>
                <input id="send-new-statement" type="button" name="" value="Save my Statement!" class="btn btn-primary" data-dismiss="modal" data-toggle="tooltip" data-placement="bottom" tal:attributes="value extras.buttons.save_my_statement; name discussion.mode"/>
            </div>
        </div>

        <div class="container colored-container" id="add-premise-container" style="display:none" tal:attributes="style extras.add_premise_container_style">
            <button tal:condition="extras.close_premise_container" id="close-premise-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="col-md-12 text-center">
                <h5>${structure:extras.tag.add_premise_title}</h5>
                <p class="lead" id="add-premise-container-main-input-intro">${structure:discussion.add_premise_text}</p>
                <div id="add-premise-error-container" class="alert alert-danger" role="alert" style="display:none">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    <span id="add-premise-error-msg"></span>
                </div>
                <div id="add-premise-container-body">
                    <div class="container-three-divs" style="padding-bottom: 2em;">
                        <div class="flex-div">
                            <input id="add-premise-container-main-input" type="text" class="add-preise-container-input form-control" name="" autocomplete="off" placeholder="..." value="" data-min-length="10" data-max-length="140">
                        </div>
                        <div><img class="icon-badge icon-rem-premise" src="${request.static_url('dbas:static/images/icon_minus1.png')}" tal:attributes="title extras.title.rem_statement_row_title"/><img class="icon-badge icon-add-premise" src="${request.static_url('dbas:static/images/icon_plus1.png')}" tal:attributes="title extras.title.add_statement_row_title"/></div>
                    </div>
                </div>
                <div class="list-group" id="proposal-premise-list-group"></div>
                <input id="send-new-premise" type="button" name="" value="Save my Statement!" class="btn btn-primary" data-dismiss="modal" data-toggle="tooltip" data-placement="bottom" tal:attributes="value extras.buttons.save_my_statement; name discussion.mode"/>
            </div>
        </div>

        <div class="container colored-container" id="display-control-container" tal:condition="extras.show_island_icon" style="display:none">
            <div class="row">
                <h4 i18n:translate="change_style">Change display style</h4>
                <div class="col-md-4">
                    <input type="radio" id="sc-style-1" checked value="Dialog View">
                    <label id="label-sc-style-1" for="sc-style-1" data-value="Dialog View" i18n:translate="dialog_view">Dialog View </label>
                    <br>
                    <img id="display-control-container-icon-guided" class="icon-badge" alt="icon-guided" src="${request.static_url('dbas:static/images/icon_guided.png')}" />
                </div>
                <div class="col-md-4">
                    <input type="radio" id="sc-style-2" value="Island View">
                    <label id="label-sc-style-2" for="sc-style-2" data-value="Island View" i18n:translate="island_view">Island View</label>
                    <br>
                    <img id="display-control-container-icon-island" class="icon-badge" alt="icon-island" src="${request.static_url('dbas:static/images/icon_island.png')}" />
                </div>
                <div class="col-md-4">
                    <input type="radio" id="sc-style-3" value="Complete View">
                    <label id="label-sc-style-3" for="sc-style-3" data-value="Complete View" i18n:translate="complete_view">Complete View</label>
                    <br>
                    <img id="display-control-container-icon-expert" class="icon-badge" alt="icon-expert" src="${request.static_url('dbas:static/images/icon_expert.png')}" />
                </div>
            </div>
        </div>

        <script type="text/javascript" src="${request.static_url('dbas:static/js/discussion/guihandler.js')}"></script>
        <script type="text/javascript" src="${request.static_url('dbas:static/js/discussion/interactionhandler.js')}"></script>
        <script type="text/javascript" src="${request.static_url('dbas:static/js/discussion/helper.js')}"></script>
        <script type="text/javascript" src="${request.static_url('dbas:static/js/discussion/main.js')}"></script>

        <script tal:condition="extras.show_bar_icon" type="text/javascript" src="${request.static_url('dbas:static/js/discussion/barometer.js')}"></script>

        <script tal:condition="extras.show_expert_icon" type="text/javascript" src="${request.static_url('dbas:static/js/d3/graph.js')}"></script>
        <script tal:condition="extras.show_expert_icon" type="text/javascript" src="${request.static_url('dbas:static/js/d3/d3.min.js')}"></script>

        <script type="text/javascript" src="${request.static_url('dbas:static/js/libs/chart.min.js')}"></script>

    </tal:block>
</tal:block>