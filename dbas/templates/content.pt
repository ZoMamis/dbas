<tal:block metal:use-macro="layout" i18n:domain="dbas" metal:define-macro="layout">
    <tal:block metal:fill-slot="content_page">

        <div class="container colored-container" id="header-container">
            <div class="row cn">
                <div class="col-md-8" tal:condition="len(issues.all)>1">
                    <p class="center">${structure:issues.intro}:</p>
                    <span class="lead" id="issue_info" tal:attributes="data-discussion-language extras.tag.language; data-title issues.title" style="text-align: justify;">${structure:issues.info}</span>
                    <i id="issue-info" class="fa fa-info-circle" aria-hidden="true" data-toggle="tooltip" data-placement="auto" tal:attributes="data-original-title issues.tooltip"></i>
                </div>
                <div class="col-md-10" tal:condition="len(issues.all)<2">
                    <p class="center">${structure:issues.intro}:</p>
                    <span class="lead" id="issue_info" tal:attributes="data-discussion-language extras.tag.language; data-title issues.title" style="text-align: justify;">${structure:issues.info}</span>
                    <i id="issue-info" class="fa fa-info-circle" aria-hidden="true" data-toggle="tooltip" data-placement="auto" tal:attributes="data-original-title issues.tooltip"></i>
                </div>
                <div class="col-md-2 center inner" tal:condition="len(issues.all)>1">
                    <div class="dropdown">
                        <button class="btn btn-primary dropdown-toggle btn-sm" type="button" id="issue-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" tal:attributes="issue issues.uid">
                            <span i18n:translate="switch_topc">Switch Topic</span>&#160;&#160;<span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" id="dropdown-issue-list" aria-labelledby="issue-dropdown" style="width: 280px;">
                            <li tal:repeat="issue issues.all" tal:attributes="class issue.enabled">
                                <a href="#" tal:attributes="href issue.url; data-value issue.title">
                                <div class="row" style="padding: 0;">
                                    <div class="col-md-10" style="white-space: pre-wrap;">${structure:issue.title}</div>
                                    <div class="col-md-2">
                                        <span class="badge" data-toggle="tooltip" data-placement="bottom" tal:attributes="title extras.buttons.count_of_posts">${issue.stat_count}
                                        </span>
                                    </div>
                                </div>
                                </a>
                            </li>
                            <li tal:condition="extras.is_admin or extras.is_author" role="separator" class="divider"></li>
                            <li tal:condition="extras.is_admin or extras.is_author" role="separator">
                                <a id="add-topic" href="#" i18n:translate="add_topic">Add a Topic</a>
                            </li>
                        </ul>
                    </div>
                 </div>
                <div class="col-md-2 center inner">
                    <button id="discussion-restart-btn" class="btn btn-primary btn-sm" data-dismiss="modal" type="button" onclick="" tal:attributes="onclick extras.restart_url">
                        <span i18n:translate="restart_discussion">Restart</span>&#160;&#160;<i class="fa fa-refresh" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="container colored-container" id="discussion-container">
            <div id="dialog-wrapper" class="content-wrapper pull-left">

                <div id="discussion-error-description-space" class="alert alert-danger alert-dismissible hidden">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <span id="discussion-error-description"></span>
                </div>

                <div id="discussion-success-description-space" class="alert alert-success alert-dismissible hidden">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <strong i18n:translate="success">Success</strong>
                    <span id="discussion-success-description"></span>
                </div>

                 <div id="dialog-speech-bubbles-space">
                        <div tal:repeat="bubble discussion.bubbles" tal:omit-tag="">
                            <div tal:condition="bubble.is_user" class="line-wrapper-r">
                                <p class="triangle-r" tal:attributes="id bubble.id">
                                    <!--<img class="triangle-gravatar-r" tal:attributes="src extras.users_avatar">-->
                                    <a tal:omit-tag="bubble.omit_url" tal:attributes="href bubble.url; title extras.buttons.lets_go_back" data-toggle="tooltip" data-placement="bottom">
                                        <span class="triangle-content">${structure:bubble.message}</span>
                                    </a>
                                    <br>
                                    <em class="triangle-r-info" tal:attributes="data-type bubble.data_type; data-argument-uid bubble.data_argument_uid; data-statement-uid bubble.data_statement_uid; data-votecount bubble.votecounts; data-is-supportive bubble.data_is_supportive">${bubble.votecounts_message}</em>
                                </p>
                            </div>
                            <div tal:condition="bubble.is_system" class="line-wrapper-l">
                                <p class="triangle-l" tal:attributes="id bubble.id">
                                    <!--<img class="triangle-gravatar-l"  tal:attributes="src extras.users_avatar">-->
                                    <span class="triangle-content">${structure:bubble.message}</span>
                                    <br tal:condition="bubble.is_flagable and extras.logged_in">
                                    <span class="triangle-trash pull-right" tal:condition="bubble.is_author and extras.logged_in">
                                        <i class="fa fa-trash" aria-hidden="true" tal:attributes="title extras.title.delete_statement"></i>
                                    </span>
                                    <span class="triangle-flag pull-right" tal:condition="bubble.is_flagable and extras.logged_in">
                                        <i class="fa fa-flag" aria-hidden="true"  tal:attributes="title extras.title.report_statement"></i>
                                    </span>
                                    <span class="triangle-reference pull-right" tal:condition="bubble.is_flagable and extras.logged_in" >
                                        <i class="fa fa-link" aria-hidden="true" tal:attributes="title extras.title.reference"></i>
                                    </span>
                                </p>
                            </div>
                            <div tal:condition="bubble.is_status" class="line-wrapper-m">
                                <p class="triangle-m" tal:attributes="id bubble.id">${structure:bubble.message}</p>
                            </div>
                            <div tal:condition="bubble.is_info" class="line-wrapper-m">
                                <p class="triangle-m-info" tal:attributes="id bubble.id">${structure:bubble.message}</p>
                            </div>
                       </div>
                    </div>
                <div id="discussions-space">
                    <ul id="discussions-space-list">
                        <li tal:repeat="item items.elements" tal:attributes="style item.style">
                            <input id="tmp" type="radio" name="discussion-button-group" onclick="" tal:attributes="id item.id; onclick item.url; data-url item.url">
                            <span tal:repeat="premise item.premises" tal:omit-tag="">
                                <label for="tmp" tal:attributes="for item.id; id premise.id" data-toggle="tooltip" data-placement="auto">${structure:premise.title}</label>
                                <label tal:attributes="for item.id" tal:condition="not:repeat.premise.end"><em>${extras.tag.aand}</em></label>
                                <label tal:condition="repeat.premise.end and item.already_used"><em>${item.already_used_text}</em></label>
                                <div tal:omit-tag="" tal:condition="repeat.premise.end and extras.logged_in">
                                    <div tal:omit-tag="" tal:condition="item.is_editable or item.is_flagable or item.is_deletable">
                                        <span style="margin-left: 1em" tal:condition="item.is_editable or item.is_flagable or item.is_deletable"></span>
                                        <span class="item-edit" tal:condition="item.is_editable" tal:attributes="title extras.title.edit_statement">
                                            <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                        </span>
                                        <span class="item-flag" tal:condition="item.is_flagable " tal:attributes="title extras.title.report_statement">
                                            <i class="fa fa-flag" aria-hidden="true"></i>
                                        </span>
                                        <!--<span class="item-trash" tal:condition="item.is_deletable" tal:attributes="title extras.title.delete_statement">-->
                                        <span class="item-trash" tal:condition="item.is_deletable" tal:attributes="title extras.title.disassociate_statement">
                                            <i class="fa fa-times" aria-hidden="true"></i>
                                        </span>
                                        <span class="item-reference" tal:attributes="title extras.title.reference">
                                            <span style="margin-left: 1em" tal:condition="not:(item.is_editable or item.is_flagable or item.is_deletable)"></span>
                                            <i class="fa fa-link" aria-hidden="true"></i>
                                        </span>
                                    </div>
                                </div>
                            </span>
                        </li>
                    </ul>
                    <div tal:condition="items.extras.cropped_list" style="padding-left: 40px;">
                        <a id="show-all-elements-in-discussion-space" href="#" class="btn btn-primary btn-xs"><span i18n:translate="show_all_statements">Show all statements</span></a>
                        <a id="hide-elements-in-discussion-space" href="#" class="btn btn-primary btn-xs" style="display:none;"><span i18n:translate="hide_statements">Hide statements</span></a>
                    </div>
                </div>
            </div>

            <div class="pull-right sidebar-wrapper">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>

                <ul class="sidebar">
                    <li id="share-url" tal:attributes="titel extras.buttons.share_url"><i class="fa fa-share" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.share_url}</span></li>
                    <li id="opinion-barometer-img" tal:attributes="titel extras.title.barometer" tal:condition="extras.show_bar_icon"><i class="fa fa-bar-chart" aria-hidden="true"></i><span class="sidebar-element">${extras.title.barometer}</span></li>
                    <li id="display-style-icon-island-img" tal:attributes="titel extras.title.island_view"  tal:condition="extras.show_island_icon and False"><i class="fa fa-map-o" aria-hidden="true"></i><span class="sidebar-element">${extras.title.island_view}</span></li>
                    <li id="display-style-icon-graph-img" tal:attributes="titel extras.title.graph_view" tal:condition="extras.show_graph_icon"><i class="fa fa-sitemap" aria-hidden="true"></i><span class="sidebar-element">${extras.title.graph_view}</span></li>
                    <li id="finish-button" tal:attributes="titel extras.title.finish_title" onclick="window.location='/discuss/finish'"><i class="fa fa-sign-out" aria-hidden="true"></i><span class="sidebar-element">${extras.title.finish_title}</span></li>
                </ul>

                <div class="tack-wrapper" data-toggle="tooltip" data-placement="bottom">
                    <i class="tack fa fa-thumb-tack" aria-hidden="true"></i>
                </div>
            </div>
        </div>

        <div class="container colored-container" id="island-view-container" style="display:none" tal:condition="extras.show_island_icon">
            <div class="row">
                <button id="close-island-view-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="row" id="island-view-container-space">

                <div class="row">
                    <div class="col-md-6">
                        <div class="bs-callout bs-callout-danger">
                            <h4>
                                <span class="text-danger">&#10008;</span>
                                <span class="lead">${structure:extras.island.undermine_text}</span>
                            </h4>
                            <div>
                                <ul>
                                    <li tal:repeat="undermine extras.island.undermine" tal:attributes="id undermine.id">
                                        <label tal:attributes="for undermine.id">${structure:undermine.text}</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="row">
                                <div class="col-md-offset-6 col-md-6">
                                    <button id="island-view-undermine-button" type="button" class="btn btn-primary" data-dismiss="modal">${extras.buttons.resume_here}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="bs-callout bs-callout-success">
                            <h4>
                                <span class="text-success">&#10004;</span>
                                <span class="lead">${structure:extras.island.support_text}</span>
                            </h4>
                            <div>
                                <ul>
                                    <li tal:repeat="support extras.island.support" tal:attributes="id support.id">
                                        <label tal:attributes="for support.id">${structure:support.text}</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="row">
                                <div class="col-md-offset-6 col-md-6">
                                    <button id="island-view-support-button" type="button" class="btn btn-primary" data-dismiss="modal">${extras.buttons.resume_here}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="bs-callout bs-callout-info">
                            <h4>
                                <span class="text-info">&#10134</span>
                                <span class="lead">${structure:extras.island.undercut_text}</span>
                            </h4>
                            <div>
                                <ul>
                                    <li tal:repeat="undercut extras.island.undercut" tal:attributes="id undercut.id">
                                        <label tal:attributes="for undercut.id">${structure:undercut.text}</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="row">
                                <div class="col-md-offset-6 col-md-6">
                                    <button id="island-view-undercut-button" type="button" class="btn btn-primary" data-dismiss="modal">${extras.buttons.resume_here}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="bs-callout bs-callout-info">
                            <h4>
                                <span class="text-info">&#10134;</span>
                                <span class="lead">${structure:extras.island.rebut_text}</span>
                            </h4>
                            <div>
                                <ul>
                                    <li tal:repeat="rebut extras.island.rebut" tal:attributes="id rebut.id">
                                        <label tal:attributes="for rebut.id">${structure:rebut.text}</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="row">
                                <div class="col-md-offset-6 col-md-6">
                                    <button id="island-view-rebut-button" type="button" class="btn btn-primary" data-dismiss="modal">${extras.buttons.resume_here}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="colored-container" id="graph-view-container" style="display:none">
            <div class="pull-left content-wrapper">
                <button id="close-graph-view-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 id="graph-view-container-header" class="center"></h4>
                <div id="graph-view-container-space" style="height:95%;">
                </div>
            </div>

            <div class="pull-right sidebar-wrapper">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>

                <ul class="sidebar">
                    <li id="start-view"><i class="fa fa-fast-backward" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.default_view}</span></li>
                    <li id="show-labels"><i class="fa fa-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.labels}</span></li>
                    <li id="hide-labels"><i class="fa fa-check-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.labels}</span></li>
                    <li class="indented-button" id="show-positions"><i class="fa fa-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.positions}</span></li>
                    <li class="indented-button" id="hide-positions"><i class="fa fa-check-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.positions}</span></li>
                    <li id="my-path"><i class="fa fa-map-signs" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.my_path}</span></li>
                    <li id="show-my-statements" tal:condition="extras.logged_in"><i class="fa fa-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.my_statements}</span></li>
                    <li id="hide-my-statements" tal:condition="extras.logged_in"><i class="fa fa-check-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.my_statements}</span></li>
                    <li class="indented-button" id="show-supports-on-my-statements" tal:condition="extras.logged_in"><i class="fa fa-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.supports_on_my_statements}</span></li>
                    <li class="indented-button" id="hide-supports-on-my-statements" tal:condition="extras.logged_in"><i class="fa fa-check-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.supports_on_my_statements}</span></li>
                    <li class="indented-button" id="show-attacks-on-my-statements" tal:condition="extras.logged_in"><i class="fa fa-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.attacks_on_my_statements}</span></li>
                    <li class="indented-button" id="hide-attacks-on-my-statements" tal:condition="extras.logged_in"><i class="fa fa-check-square-o" aria-hidden="true"></i><span class="sidebar-element">${extras.buttons.attacks_on_my_statements}</span></li>
                </ul>

                <div class="tack-wrapper" data-toggle="tooltip" data-placement="bottom">
                    <i class="tack fa fa-thumb-tack" aria-hidden="true"></i>
                </div>
            </div>
        </div>

        <div class="container colored-container" id="add-statement-container" style="display:none" tal:attributes="style extras.add_statement_container_style">
            <button tal:condition="extras.close_statement_container" id="close-statement-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <br>
            <div class="col-md-12 text-center">
                <h5>${structure:discussion.add_premise_text}</h5>
                <div id="add-statement-error-container" class="alert alert-danger" role="alert" style="display:none">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                    <span id="add-statement-error-msg"></span>
                </div>
                <div id="add-statement-container-body">

            	<div class="form-group">
            		<div class="col-sm-12 input-group">
                        <div class="input-group-addon"><i class="fa fa-commenting fa-2x" aria-hidden="true"></i></div>
            			<input id="add-statement-container-main-input" type="text" class="form-control"  placeholder="..." value="" data-min-length="10"  data-max-length="160" style="width: 100%">
            		</div>
            	</div>

                </div>
                <div class="list-group" id="proposal-statement-list-group"></div>
                <input id="send-new-statement" type="button" name="" value="Save my Statement!" class="btn btn-primary" data-dismiss="modal" data-toggle="tooltip" data-placement="bottom" tal:attributes="value extras.buttons.save_my_statement; name discussion.mode"/>
            </div>
        </div>

        <div class="container colored-container" id="add-premise-container" style="display:none" tal:attributes="style extras.add_premise_container_style">
            <button tal:condition="extras.close_premise_container" id="close-premise-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="col-md-12 text-center">
                <h5>${structure:extras.tag.add_premise_title}</h5>
                <p class="lead" id="add-premise-container-main-input-intro">${structure:discussion.add_premise_text}</p>
                <div id="add-premise-error-container" class="alert alert-danger" role="alert" style="display:none">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                    <span id="add-premise-error-msg"></span>
                </div>
                <div id="add-premise-container-body">
                    <div class="container-three-divs" style="padding-bottom: 2em;">
                        <div class="flex-div">

            	            <div class="form-group">
            		            <div class="col-sm-12 input-group">
                                    <div class="input-group-addon"><i class="fa fa-commenting fa-2x" aria-hidden="true"></i></div>
                        			<input id="add-premise-container-main-input" type="text" class="form-control"  placeholder="..." value="" data-min-length="10"  data-max-length="160" style="width: 100%">
            		            </div>
            	            </div>

                        </div>
                        <div><img class="icon-badge icon-rem-premise" alt="rem" src="${request.static_url('dbas:static/images/icon_minus1.png')}" tal:attributes="title extras.title.rem_statement_row_title"/><img class="icon-badge icon-add-premise" alt="add" src="${request.static_url('dbas:static/images/icon_plus1.png')}" tal:attributes="title extras.title.add_statement_row_title"/></div>
                    </div>
                </div>
                <div class="list-group" id="proposal-premise-list-group"></div>
                <input id="send-new-premise" type="button" name="" value="Save my Statement!" class="btn btn-primary" data-dismiss="modal" data-toggle="tooltip" data-placement="bottom" tal:attributes="value extras.buttons.save_my_statement; name discussion.mode"/>
            </div>
        </div>

        <script type="text/javascript" src="${request.static_url('dbas:static/js/discussion/interactionhandler.js')}"></script>
        <script type="text/javascript" src="${request.static_url('dbas:static/js/discussion/main.js')}"></script>
        <script tal:condition="extras.show_bar_icon" type="text/javascript" src="${request.static_url('dbas:static/js/d3/barometer.js')}"></script>
        <script tal:condition="extras.show_graph_icon" type="text/javascript" src="${request.static_url('dbas:static/js/d3/graph.js')}"></script>
        <script tal:condition="extras.show_graph_icon or extras.show_bar_icon" type="text/javascript" src="${request.static_url('dbas:static/js/d3/d3.min.js')}"></script>

    </tal:block>
</tal:block>